/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 8622.17 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 8198.17 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                    
                                                                                                                                                                    
{'eval_loss': 0.39793282747268677, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.898614641194395, 'eval_runtime': 3.961, 'eval_samples_per_second': 191.87, 'eval_steps_per_second': 23.984, 'epoch': 0.23}
{'eval_loss': 0.3613373935222626, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9010394883873896, 'eval_runtime': 3.9086, 'eval_samples_per_second': 194.442, 'eval_steps_per_second': 24.305, 'epoch': 0.47}
{'loss': 0.5576, 'grad_norm': 0.5836976766586304, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.2970508337020874, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233816193515919, 'eval_runtime': 3.9025, 'eval_samples_per_second': 194.749, 'eval_steps_per_second': 24.344, 'epoch': 0.7}
{'eval_loss': 0.395367830991745, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8950598040170801, 'eval_runtime': 3.8715, 'eval_samples_per_second': 196.304, 'eval_steps_per_second': 24.538, 'epoch': 0.94}
{'loss': 0.4155, 'grad_norm': 55.096317291259766, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.3936970829963684, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9188851178386782, 'eval_runtime': 3.8814, 'eval_samples_per_second': 195.803, 'eval_steps_per_second': 24.475, 'epoch': 1.17}
{'eval_loss': 0.359981894493103, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9175200951259364, 'eval_runtime': 3.9438, 'eval_samples_per_second': 192.708, 'eval_steps_per_second': 24.088, 'epoch': 1.4}
{'eval_loss': 0.40668153762817383, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.905717233207828, 'eval_runtime': 3.9121, 'eval_samples_per_second': 194.27, 'eval_steps_per_second': 24.284, 'epoch': 1.64}
{'loss': 0.3768, 'grad_norm': 17.448991775512695, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3499941825866699, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9145261515664208, 'eval_runtime': 3.9415, 'eval_samples_per_second': 192.819, 'eval_steps_per_second': 24.102, 'epoch': 1.87}
{'eval_loss': 0.3031615912914276, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246422914644604, 'eval_runtime': 3.8975, 'eval_samples_per_second': 194.998, 'eval_steps_per_second': 24.375, 'epoch': 2.11}
{'loss': 0.3305, 'grad_norm': 55.911434173583984, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.4185866415500641, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9086209642279838, 'eval_runtime': 3.935, 'eval_samples_per_second': 193.141, 'eval_steps_per_second': 24.143, 'epoch': 2.34}
{'eval_loss': 0.3570261001586914, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9059245958994647, 'eval_runtime': 3.9146, 'eval_samples_per_second': 194.145, 'eval_steps_per_second': 24.268, 'epoch': 2.57}
{'eval_loss': 0.30358973145484924, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9266921647490072, 'eval_runtime': 3.9152, 'eval_samples_per_second': 194.115, 'eval_steps_per_second': 24.264, 'epoch': 2.81}
{'loss': 0.299, 'grad_norm': 44.943695068359375, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.3722645938396454, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9188587105176332, 'eval_runtime': 3.9667, 'eval_samples_per_second': 191.594, 'eval_steps_per_second': 23.949, 'epoch': 3.04}
{'eval_loss': 0.36393776535987854, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9254576499728855, 'eval_runtime': 3.9021, 'eval_samples_per_second': 194.767, 'eval_steps_per_second': 24.346, 'epoch': 3.27}
{'loss': 0.2604, 'grad_norm': 9.175203323364258, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.3839931786060333, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9165707807377339, 'eval_runtime': 3.9219, 'eval_samples_per_second': 193.784, 'eval_steps_per_second': 24.223, 'epoch': 3.51}
{'eval_loss': 0.41293472051620483, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206476855985253, 'eval_runtime': 3.9847, 'eval_samples_per_second': 190.731, 'eval_steps_per_second': 23.841, 'epoch': 3.74}
{'eval_loss': 0.3640173673629761, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9118381048847233, 'eval_runtime': 3.8905, 'eval_samples_per_second': 195.346, 'eval_steps_per_second': 24.418, 'epoch': 3.98}
{'loss': 0.2301, 'grad_norm': 0.07156466692686081, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.40155836939811707, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9153369367667455, 'eval_runtime': 3.9476, 'eval_samples_per_second': 192.522, 'eval_steps_per_second': 24.065, 'epoch': 4.21}
{'eval_loss': 0.324252188205719, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9220913258703873, 'eval_runtime': 3.8774, 'eval_samples_per_second': 196.007, 'eval_steps_per_second': 24.501, 'epoch': 4.44}
{'loss': 0.1791, 'grad_norm': 11.662851333618164, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.36826300621032715, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.923570169550517, 'eval_runtime': 3.9123, 'eval_samples_per_second': 194.258, 'eval_steps_per_second': 24.282, 'epoch': 4.68}
{'eval_loss': 0.3760106861591339, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9254699354881336, 'eval_runtime': 3.9726, 'eval_samples_per_second': 191.31, 'eval_steps_per_second': 23.914, 'epoch': 4.91}
{'eval_loss': 0.3925294876098633, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9261247984802066, 'eval_runtime': 3.8889, 'eval_samples_per_second': 195.429, 'eval_steps_per_second': 24.429, 'epoch': 5.15}
{'loss': 0.1906, 'grad_norm': 0.04649687185883522, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.3153264820575714, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9274723043367545, 'eval_runtime': 3.9597, 'eval_samples_per_second': 191.934, 'eval_steps_per_second': 23.992, 'epoch': 5.38}
{'eval_loss': 0.46557319164276123, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9129988279706878, 'eval_runtime': 3.9149, 'eval_samples_per_second': 194.13, 'eval_steps_per_second': 24.266, 'epoch': 5.61}
{'loss': 0.1454, 'grad_norm': 0.1380622237920761, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.43142932653427124, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9115042200066117, 'eval_runtime': 3.8969, 'eval_samples_per_second': 195.027, 'eval_steps_per_second': 24.378, 'epoch': 5.85}
{'eval_loss': 0.3883848786354065, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9194623449142251, 'eval_runtime': 3.9252, 'eval_samples_per_second': 193.623, 'eval_steps_per_second': 24.203, 'epoch': 6.08}
{'eval_loss': 0.3892959654331207, 'eval_accuracy': 0.9368421052631579, 'eval_micro_f1': 0.9368421052631579, 'eval_macro_f1': 0.9352689316738743, 'eval_runtime': 3.883, 'eval_samples_per_second': 195.725, 'eval_steps_per_second': 24.466, 'epoch': 6.32}
{'loss': 0.1434, 'grad_norm': 0.14870095252990723, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.46275097131729126, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9149154293826531, 'eval_runtime': 3.9182, 'eval_samples_per_second': 193.966, 'eval_steps_per_second': 24.246, 'epoch': 6.55}
{'eval_loss': 0.42915186285972595, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9221015527617991, 'eval_runtime': 3.9724, 'eval_samples_per_second': 191.318, 'eval_steps_per_second': 23.915, 'epoch': 6.78}
{'loss': 0.1275, 'grad_norm': 0.06161569058895111, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.4465211033821106, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9234373051398518, 'eval_runtime': 3.9185, 'eval_samples_per_second': 193.952, 'eval_steps_per_second': 24.244, 'epoch': 7.02}
{'eval_loss': 0.4173981845378876, 'eval_accuracy': 0.9368421052631579, 'eval_micro_f1': 0.9368421052631579, 'eval_macro_f1': 0.9350224844965359, 'eval_runtime': 3.8915, 'eval_samples_per_second': 195.295, 'eval_steps_per_second': 24.412, 'epoch': 7.25}
{'eval_loss': 0.42288070917129517, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9182475630191571, 'eval_runtime': 3.9116, 'eval_samples_per_second': 194.296, 'eval_steps_per_second': 24.287, 'epoch': 7.49}
{'loss': 0.0905, 'grad_norm': 3.5657472610473633, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.4459551274776459, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.924564451974713, 'eval_runtime': 3.9281, 'eval_samples_per_second': 193.479, 'eval_steps_per_second': 24.185, 'epoch': 7.72}
{'eval_loss': 0.40640825033187866, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9267636507473962, 'eval_runtime': 3.9815, 'eval_samples_per_second': 190.881, 'eval_steps_per_second': 23.86, 'epoch': 7.95}
{'loss': 0.0866, 'grad_norm': 0.05234676972031593, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.4245796203613281, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9221144448379957, 'eval_runtime': 3.8962, 'eval_samples_per_second': 195.061, 'eval_steps_per_second': 24.383, 'epoch': 8.19}
{'eval_loss': 0.4425276815891266, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9219945677553911, 'eval_runtime': 3.8934, 'eval_samples_per_second': 195.202, 'eval_steps_per_second': 24.4, 'epoch': 8.42}
{'eval_loss': 0.4509761333465576, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.926037829880341, 'eval_runtime': 3.9505, 'eval_samples_per_second': 192.38, 'eval_steps_per_second': 24.048, 'epoch': 8.65}
{'loss': 0.063, 'grad_norm': 0.07862963527441025, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.43015289306640625, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9314479323942559, 'eval_runtime': 3.8534, 'eval_samples_per_second': 197.227, 'eval_steps_per_second': 24.653, 'epoch': 8.89}
{'eval_loss': 0.42240986227989197, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9312810876408119, 'eval_runtime': 3.915, 'eval_samples_per_second': 194.124, 'eval_steps_per_second': 24.265, 'epoch': 9.12}
{'loss': 0.0635, 'grad_norm': 0.10554726421833038, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.4184282720088959, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9326054268901394, 'eval_runtime': 3.8377, 'eval_samples_per_second': 198.035, 'eval_steps_per_second': 24.754, 'epoch': 9.36}
{'eval_loss': 0.4394019544124603, 'eval_accuracy': 0.9302631578947368, 'eval_micro_f1': 0.9302631578947368, 'eval_macro_f1': 0.9286418794570968, 'eval_runtime': 3.8941, 'eval_samples_per_second': 195.167, 'eval_steps_per_second': 24.396, 'epoch': 9.59}
{'eval_loss': 0.4330608546733856, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9313276567841695, 'eval_runtime': 3.9661, 'eval_samples_per_second': 191.626, 'eval_steps_per_second': 23.953, 'epoch': 9.82}
{'loss': 0.0422, 'grad_norm': 0.0351666659116745, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1706.8931, 'train_samples_per_second': 40.073, 'train_steps_per_second': 5.009, 'train_loss': 0.21067800451788987, 'epoch': 10.0}
