/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 13479.63 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 12472.89 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                    
                                                                                                                                                                    
{'eval_loss': 0.3769665062427521, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9069680080112801, 'eval_runtime': 3.957, 'eval_samples_per_second': 192.062, 'eval_steps_per_second': 24.008, 'epoch': 0.23}
{'eval_loss': 0.30432870984077454, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114287740138466, 'eval_runtime': 3.9476, 'eval_samples_per_second': 192.522, 'eval_steps_per_second': 24.065, 'epoch': 0.47}
{'loss': 0.4706, 'grad_norm': 0.3781434893608093, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.28983360528945923, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246317458099629, 'eval_runtime': 3.9555, 'eval_samples_per_second': 192.138, 'eval_steps_per_second': 24.017, 'epoch': 0.7}
{'eval_loss': 0.31339913606643677, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9155226123227622, 'eval_runtime': 3.9136, 'eval_samples_per_second': 194.197, 'eval_steps_per_second': 24.275, 'epoch': 0.94}
{'loss': 0.3589, 'grad_norm': 0.2281433343887329, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.4202900230884552, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088978067837581, 'eval_runtime': 3.9479, 'eval_samples_per_second': 192.507, 'eval_steps_per_second': 24.063, 'epoch': 1.17}
{'eval_loss': 0.42071548104286194, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9137459228599503, 'eval_runtime': 3.9417, 'eval_samples_per_second': 192.809, 'eval_steps_per_second': 24.101, 'epoch': 1.4}
{'eval_loss': 0.31823980808258057, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9197656670596769, 'eval_runtime': 3.9562, 'eval_samples_per_second': 192.104, 'eval_steps_per_second': 24.013, 'epoch': 1.64}
{'loss': 0.2904, 'grad_norm': 5.328208923339844, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.31191080808639526, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9116724454103625, 'eval_runtime': 4.0176, 'eval_samples_per_second': 189.169, 'eval_steps_per_second': 23.646, 'epoch': 1.87}
{'eval_loss': 0.3964275121688843, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.91443434916798, 'eval_runtime': 3.9365, 'eval_samples_per_second': 193.065, 'eval_steps_per_second': 24.133, 'epoch': 2.11}
{'loss': 0.2183, 'grad_norm': 19.70903968811035, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.43661925196647644, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9112612549099885, 'eval_runtime': 3.9461, 'eval_samples_per_second': 192.594, 'eval_steps_per_second': 24.074, 'epoch': 2.34}
{'eval_loss': 0.3878495395183563, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9234007469451511, 'eval_runtime': 3.947, 'eval_samples_per_second': 192.554, 'eval_steps_per_second': 24.069, 'epoch': 2.57}
{'eval_loss': 0.44372138381004333, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206004716152317, 'eval_runtime': 3.9807, 'eval_samples_per_second': 190.923, 'eval_steps_per_second': 23.865, 'epoch': 2.81}
{'loss': 0.1778, 'grad_norm': 37.14847183227539, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.36294257640838623, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9207987716065206, 'eval_runtime': 3.9578, 'eval_samples_per_second': 192.028, 'eval_steps_per_second': 24.004, 'epoch': 3.04}
{'eval_loss': 0.4571821391582489, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9151310943422705, 'eval_runtime': 3.953, 'eval_samples_per_second': 192.258, 'eval_steps_per_second': 24.032, 'epoch': 3.27}
{'loss': 0.1125, 'grad_norm': 0.13178417086601257, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.4872579574584961, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9204151429938295, 'eval_runtime': 3.9409, 'eval_samples_per_second': 192.85, 'eval_steps_per_second': 24.106, 'epoch': 3.51}
{'eval_loss': 0.4164358079433441, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9202254698673977, 'eval_runtime': 3.9633, 'eval_samples_per_second': 191.757, 'eval_steps_per_second': 23.97, 'epoch': 3.74}
{'eval_loss': 0.4136114716529846, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9166074063643027, 'eval_runtime': 3.962, 'eval_samples_per_second': 191.821, 'eval_steps_per_second': 23.978, 'epoch': 3.98}
{'loss': 0.1073, 'grad_norm': 0.004987586289644241, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.5794408321380615, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.906665743942871, 'eval_runtime': 3.944, 'eval_samples_per_second': 192.698, 'eval_steps_per_second': 24.087, 'epoch': 4.21}
{'eval_loss': 0.5362980365753174, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.908212998212306, 'eval_runtime': 3.937, 'eval_samples_per_second': 193.04, 'eval_steps_per_second': 24.13, 'epoch': 4.44}
{'loss': 0.0476, 'grad_norm': 0.008883493021130562, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.530124843120575, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9191606112321845, 'eval_runtime': 3.9159, 'eval_samples_per_second': 194.082, 'eval_steps_per_second': 24.26, 'epoch': 4.68}
{'eval_loss': 0.5469533205032349, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9153108674497777, 'eval_runtime': 3.9215, 'eval_samples_per_second': 193.805, 'eval_steps_per_second': 24.226, 'epoch': 4.91}
{'eval_loss': 0.5581422448158264, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9187616193837082, 'eval_runtime': 3.9383, 'eval_samples_per_second': 192.976, 'eval_steps_per_second': 24.122, 'epoch': 5.15}
{'loss': 0.0462, 'grad_norm': 0.004683672916144133, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.5872051119804382, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9176942559808926, 'eval_runtime': 4.1451, 'eval_samples_per_second': 183.349, 'eval_steps_per_second': 22.919, 'epoch': 5.38}
{'eval_loss': 0.5881991982460022, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9170082108686017, 'eval_runtime': 4.1306, 'eval_samples_per_second': 183.993, 'eval_steps_per_second': 22.999, 'epoch': 5.61}
{'loss': 0.0259, 'grad_norm': 30.543888092041016, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.5626711845397949, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9256520923385574, 'eval_runtime': 4.0709, 'eval_samples_per_second': 186.69, 'eval_steps_per_second': 23.336, 'epoch': 5.85}
{'eval_loss': 0.575599193572998, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9234547656900599, 'eval_runtime': 4.0274, 'eval_samples_per_second': 188.706, 'eval_steps_per_second': 23.588, 'epoch': 6.08}
{'eval_loss': 0.5725317597389221, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9313437427704455, 'eval_runtime': 3.9856, 'eval_samples_per_second': 190.686, 'eval_steps_per_second': 23.836, 'epoch': 6.32}
{'loss': 0.018, 'grad_norm': 0.0017388039268553257, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.650676429271698, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9188794398922889, 'eval_runtime': 3.9521, 'eval_samples_per_second': 192.302, 'eval_steps_per_second': 24.038, 'epoch': 6.55}
{'eval_loss': 0.6038943529129028, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9249343899271701, 'eval_runtime': 3.9295, 'eval_samples_per_second': 193.409, 'eval_steps_per_second': 24.176, 'epoch': 6.78}
{'loss': 0.0128, 'grad_norm': 0.008210912346839905, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.6213849782943726, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9203207048703734, 'eval_runtime': 3.9316, 'eval_samples_per_second': 193.307, 'eval_steps_per_second': 24.163, 'epoch': 7.02}
{'eval_loss': 0.5991384983062744, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9248853732509692, 'eval_runtime': 3.9505, 'eval_samples_per_second': 192.379, 'eval_steps_per_second': 24.047, 'epoch': 7.25}
{'eval_loss': 0.602861225605011, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.923675846596563, 'eval_runtime': 3.9267, 'eval_samples_per_second': 193.547, 'eval_steps_per_second': 24.193, 'epoch': 7.49}
{'loss': 0.0077, 'grad_norm': 0.001301683485507965, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.6646609306335449, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206823230694949, 'eval_runtime': 4.0317, 'eval_samples_per_second': 188.505, 'eval_steps_per_second': 23.563, 'epoch': 7.72}
{'eval_loss': 0.6259804964065552, 'eval_accuracy': 0.9302631578947368, 'eval_micro_f1': 0.9302631578947368, 'eval_macro_f1': 0.9287079535647393, 'eval_runtime': 3.968, 'eval_samples_per_second': 191.534, 'eval_steps_per_second': 23.942, 'epoch': 7.95}
{'loss': 0.0001, 'grad_norm': 0.0007166345603764057, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.6648975610733032, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9218653351180884, 'eval_runtime': 3.9611, 'eval_samples_per_second': 191.866, 'eval_steps_per_second': 23.983, 'epoch': 8.19}
{'eval_loss': 0.6753281354904175, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9218447746792271, 'eval_runtime': 3.9551, 'eval_samples_per_second': 192.159, 'eval_steps_per_second': 24.02, 'epoch': 8.42}
{'eval_loss': 0.6789796352386475, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9205164031267095, 'eval_runtime': 3.9401, 'eval_samples_per_second': 192.891, 'eval_steps_per_second': 24.111, 'epoch': 8.65}
{'loss': 0.0001, 'grad_norm': 0.0006646589608862996, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.6653648614883423, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259864240070631, 'eval_runtime': 3.9562, 'eval_samples_per_second': 192.105, 'eval_steps_per_second': 24.013, 'epoch': 8.89}
{'eval_loss': 0.6583983898162842, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9275437917771298, 'eval_runtime': 3.9401, 'eval_samples_per_second': 192.89, 'eval_steps_per_second': 24.111, 'epoch': 9.12}
{'loss': 0.0006, 'grad_norm': 0.0012852729996666312, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.6620156168937683, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9275341064859213, 'eval_runtime': 3.9519, 'eval_samples_per_second': 192.314, 'eval_steps_per_second': 24.039, 'epoch': 9.36}
{'eval_loss': 0.6719393134117126, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9275437917771298, 'eval_runtime': 3.9486, 'eval_samples_per_second': 192.476, 'eval_steps_per_second': 24.059, 'epoch': 9.59}
{'eval_loss': 0.6732307076454163, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9275437917771298, 'eval_runtime': 3.9363, 'eval_samples_per_second': 193.073, 'eval_steps_per_second': 24.134, 'epoch': 9.82}
{'loss': 0.0019, 'grad_norm': 0.0010320437140762806, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1448.3005, 'train_samples_per_second': 47.228, 'train_steps_per_second': 5.903, 'train_loss': 0.11091875028616766, 'epoch': 10.0}
