/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:01<00:00, 6664.00 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 7227.95 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.39793282747268677, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.898614641194395, 'eval_runtime': 4.1209, 'eval_samples_per_second': 184.424, 'eval_steps_per_second': 23.053, 'epoch': 0.23}
{'eval_loss': 0.3613373935222626, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9010394883873896, 'eval_runtime': 4.0834, 'eval_samples_per_second': 186.119, 'eval_steps_per_second': 23.265, 'epoch': 0.47}
{'loss': 0.5576, 'grad_norm': 0.5836976766586304, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.2970508337020874, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233816193515919, 'eval_runtime': 4.1039, 'eval_samples_per_second': 185.188, 'eval_steps_per_second': 23.148, 'epoch': 0.7}
{'eval_loss': 0.395367830991745, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8950598040170801, 'eval_runtime': 4.0613, 'eval_samples_per_second': 187.134, 'eval_steps_per_second': 23.392, 'epoch': 0.94}
{'loss': 0.4155, 'grad_norm': 55.096317291259766, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.3936970829963684, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9188851178386782, 'eval_runtime': 4.077, 'eval_samples_per_second': 186.409, 'eval_steps_per_second': 23.301, 'epoch': 1.17}
{'eval_loss': 0.359981894493103, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9175200951259364, 'eval_runtime': 4.0853, 'eval_samples_per_second': 186.034, 'eval_steps_per_second': 23.254, 'epoch': 1.4}
{'eval_loss': 0.40668153762817383, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.905717233207828, 'eval_runtime': 3.8986, 'eval_samples_per_second': 194.939, 'eval_steps_per_second': 24.367, 'epoch': 1.64}
{'loss': 0.3768, 'grad_norm': 17.448991775512695, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3499941825866699, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9145261515664208, 'eval_runtime': 4.0908, 'eval_samples_per_second': 185.78, 'eval_steps_per_second': 23.223, 'epoch': 1.87}
{'eval_loss': 0.3031615912914276, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246422914644604, 'eval_runtime': 4.0494, 'eval_samples_per_second': 187.682, 'eval_steps_per_second': 23.46, 'epoch': 2.11}
{'loss': 0.333, 'grad_norm': 5.9635515213012695, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.3632085621356964, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9216485238089218, 'eval_runtime': 3.7992, 'eval_samples_per_second': 200.042, 'eval_steps_per_second': 25.005, 'epoch': 2.34}
{'eval_loss': 0.33453160524368286, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9208296978090909, 'eval_runtime': 3.926, 'eval_samples_per_second': 193.58, 'eval_steps_per_second': 24.197, 'epoch': 2.57}
{'eval_loss': 0.33728882670402527, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9256153035877678, 'eval_runtime': 3.9166, 'eval_samples_per_second': 194.047, 'eval_steps_per_second': 24.256, 'epoch': 2.81}
{'loss': 0.2904, 'grad_norm': 0.060610078275203705, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.4849826991558075, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8980073330021606, 'eval_runtime': 3.9047, 'eval_samples_per_second': 194.636, 'eval_steps_per_second': 24.329, 'epoch': 3.04}
{'eval_loss': 0.40220025181770325, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9174974470608479, 'eval_runtime': 3.9039, 'eval_samples_per_second': 194.676, 'eval_steps_per_second': 24.334, 'epoch': 3.27}
{'loss': 0.2512, 'grad_norm': 0.3986127972602844, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.39780622720718384, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9181165820091074, 'eval_runtime': 3.9776, 'eval_samples_per_second': 191.07, 'eval_steps_per_second': 23.884, 'epoch': 3.51}
{'eval_loss': 0.3188847005367279, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9204954634406689, 'eval_runtime': 4.0183, 'eval_samples_per_second': 189.135, 'eval_steps_per_second': 23.642, 'epoch': 3.74}
{'eval_loss': 0.3564785122871399, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9229995166936028, 'eval_runtime': 3.9216, 'eval_samples_per_second': 193.798, 'eval_steps_per_second': 24.225, 'epoch': 3.98}
{'loss': 0.2171, 'grad_norm': 0.11884097754955292, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.35974499583244324, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9309783585256483, 'eval_runtime': 4.1276, 'eval_samples_per_second': 184.125, 'eval_steps_per_second': 23.016, 'epoch': 4.21}
{'eval_loss': 0.3448006212711334, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9221704553867893, 'eval_runtime': 4.0279, 'eval_samples_per_second': 188.685, 'eval_steps_per_second': 23.586, 'epoch': 4.44}
{'loss': 0.1759, 'grad_norm': 41.1362419128418, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.40792906284332275, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9169647048117185, 'eval_runtime': 4.1003, 'eval_samples_per_second': 185.351, 'eval_steps_per_second': 23.169, 'epoch': 4.68}
{'eval_loss': 0.36466699838638306, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258639168920093, 'eval_runtime': 4.1958, 'eval_samples_per_second': 181.133, 'eval_steps_per_second': 22.642, 'epoch': 4.91}
{'eval_loss': 0.4207056164741516, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9175425679586403, 'eval_runtime': 4.0065, 'eval_samples_per_second': 189.694, 'eval_steps_per_second': 23.712, 'epoch': 5.15}
{'loss': 0.163, 'grad_norm': 0.03704867139458656, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.3348836302757263, 'eval_accuracy': 0.9302631578947368, 'eval_micro_f1': 0.9302631578947368, 'eval_macro_f1': 0.9282893020221787, 'eval_runtime': 3.9662, 'eval_samples_per_second': 191.619, 'eval_steps_per_second': 23.952, 'epoch': 5.38}
{'eval_loss': 0.3573716878890991, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9329873764836188, 'eval_runtime': 3.8974, 'eval_samples_per_second': 195.004, 'eval_steps_per_second': 24.375, 'epoch': 5.61}
{'loss': 0.1469, 'grad_norm': 0.25846007466316223, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.37819477915763855, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.921667278166392, 'eval_runtime': 4.0358, 'eval_samples_per_second': 188.312, 'eval_steps_per_second': 23.539, 'epoch': 5.85}
{'eval_loss': 0.31327399611473083, 'eval_accuracy': 0.9368421052631579, 'eval_micro_f1': 0.9368421052631579, 'eval_macro_f1': 0.9352781803994454, 'eval_runtime': 3.9108, 'eval_samples_per_second': 194.333, 'eval_steps_per_second': 24.292, 'epoch': 6.08}
{'eval_loss': 0.3321649134159088, 'eval_accuracy': 0.9394736842105263, 'eval_micro_f1': 0.9394736842105263, 'eval_macro_f1': 0.9380739820489977, 'eval_runtime': 4.0143, 'eval_samples_per_second': 189.323, 'eval_steps_per_second': 23.665, 'epoch': 6.32}
{'loss': 0.1238, 'grad_norm': 0.1730535626411438, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.42519286274909973, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9241928378763029, 'eval_runtime': 3.9244, 'eval_samples_per_second': 193.66, 'eval_steps_per_second': 24.207, 'epoch': 6.55}
{'eval_loss': 0.361803263425827, 'eval_accuracy': 0.9355263157894737, 'eval_micro_f1': 0.9355263157894737, 'eval_macro_f1': 0.9340623320529107, 'eval_runtime': 3.9526, 'eval_samples_per_second': 192.28, 'eval_steps_per_second': 24.035, 'epoch': 6.78}
{'loss': 0.1144, 'grad_norm': 0.9165440797805786, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.3287421464920044, 'eval_accuracy': 0.9368421052631579, 'eval_micro_f1': 0.9368421052631579, 'eval_macro_f1': 0.9352523178163237, 'eval_runtime': 4.0756, 'eval_samples_per_second': 186.477, 'eval_steps_per_second': 23.31, 'epoch': 7.02}
{'eval_loss': 0.3798283636569977, 'eval_accuracy': 0.9381578947368421, 'eval_micro_f1': 0.9381578947368421, 'eval_macro_f1': 0.9363301125002332, 'eval_runtime': 4.0104, 'eval_samples_per_second': 189.505, 'eval_steps_per_second': 23.688, 'epoch': 7.25}
{'eval_loss': 0.37128502130508423, 'eval_accuracy': 0.9355263157894737, 'eval_micro_f1': 0.9355263157894737, 'eval_macro_f1': 0.933851124331489, 'eval_runtime': 3.971, 'eval_samples_per_second': 191.386, 'eval_steps_per_second': 23.923, 'epoch': 7.49}
{'loss': 0.0816, 'grad_norm': 3.6802310943603516, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.4452296197414398, 'eval_accuracy': 0.9315789473684211, 'eval_micro_f1': 0.9315789473684211, 'eval_macro_f1': 0.9298967019419863, 'eval_runtime': 4.0278, 'eval_samples_per_second': 188.687, 'eval_steps_per_second': 23.586, 'epoch': 7.72}
{'eval_loss': 0.3841048777103424, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.932838268827342, 'eval_runtime': 4.0103, 'eval_samples_per_second': 189.514, 'eval_steps_per_second': 23.689, 'epoch': 7.95}
{'loss': 0.0699, 'grad_norm': 0.07625032961368561, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.4190792739391327, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9314096167359363, 'eval_runtime': 4.0002, 'eval_samples_per_second': 189.993, 'eval_steps_per_second': 23.749, 'epoch': 8.19}
{'eval_loss': 0.4467158317565918, 'eval_accuracy': 0.9355263157894737, 'eval_micro_f1': 0.9355263157894737, 'eval_macro_f1': 0.933982673184007, 'eval_runtime': 3.9914, 'eval_samples_per_second': 190.409, 'eval_steps_per_second': 23.801, 'epoch': 8.42}
{'eval_loss': 0.48101678490638733, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258335406043183, 'eval_runtime': 3.9495, 'eval_samples_per_second': 192.43, 'eval_steps_per_second': 24.054, 'epoch': 8.65}
{'loss': 0.0595, 'grad_norm': 0.21806615591049194, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.4838305711746216, 'eval_accuracy': 0.9315789473684211, 'eval_micro_f1': 0.9315789473684211, 'eval_macro_f1': 0.9299383854246223, 'eval_runtime': 3.9661, 'eval_samples_per_second': 191.626, 'eval_steps_per_second': 23.953, 'epoch': 8.89}
{'eval_loss': 0.4904063940048218, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258891387639513, 'eval_runtime': 3.9197, 'eval_samples_per_second': 193.891, 'eval_steps_per_second': 24.236, 'epoch': 9.12}
{'loss': 0.0619, 'grad_norm': 0.013245760463178158, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.4987269341945648, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233543457801884, 'eval_runtime': 3.8927, 'eval_samples_per_second': 195.239, 'eval_steps_per_second': 24.405, 'epoch': 9.36}
{'eval_loss': 0.5051649212837219, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258891387639513, 'eval_runtime': 4.0766, 'eval_samples_per_second': 186.431, 'eval_steps_per_second': 23.304, 'epoch': 9.59}
{'eval_loss': 0.4988018572330475, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259096825581847, 'eval_runtime': 4.1116, 'eval_samples_per_second': 184.842, 'eval_steps_per_second': 23.105, 'epoch': 9.82}
{'loss': 0.0427, 'grad_norm': 0.04947997257113457, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1745.1094, 'train_samples_per_second': 39.195, 'train_steps_per_second': 4.899, 'train_loss': 0.20421079033299497, 'epoch': 10.0}
