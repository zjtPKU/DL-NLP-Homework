/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 14440.91 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 13205.86 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.39793282747268677, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.898614641194395, 'eval_runtime': 3.7463, 'eval_samples_per_second': 202.867, 'eval_steps_per_second': 25.358, 'epoch': 0.23}
{'eval_loss': 0.3613373935222626, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9010394883873896, 'eval_runtime': 3.7396, 'eval_samples_per_second': 203.232, 'eval_steps_per_second': 25.404, 'epoch': 0.47}
{'loss': 0.5576, 'grad_norm': 0.5836976766586304, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.2970508337020874, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233816193515919, 'eval_runtime': 3.7393, 'eval_samples_per_second': 203.245, 'eval_steps_per_second': 25.406, 'epoch': 0.7}
{'eval_loss': 0.395367830991745, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8950598040170801, 'eval_runtime': 3.7621, 'eval_samples_per_second': 202.015, 'eval_steps_per_second': 25.252, 'epoch': 0.94}
{'loss': 0.4155, 'grad_norm': 55.096317291259766, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.3936970829963684, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9188851178386782, 'eval_runtime': 3.6685, 'eval_samples_per_second': 207.168, 'eval_steps_per_second': 25.896, 'epoch': 1.17}
{'eval_loss': 0.359981894493103, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9175200951259364, 'eval_runtime': 3.7338, 'eval_samples_per_second': 203.548, 'eval_steps_per_second': 25.443, 'epoch': 1.4}
{'eval_loss': 0.40668153762817383, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.905717233207828, 'eval_runtime': 3.7329, 'eval_samples_per_second': 203.597, 'eval_steps_per_second': 25.45, 'epoch': 1.64}
{'loss': 0.3768, 'grad_norm': 17.448991775512695, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3499941825866699, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9145261515664208, 'eval_runtime': 3.7069, 'eval_samples_per_second': 205.024, 'eval_steps_per_second': 25.628, 'epoch': 1.87}
{'eval_loss': 0.3031615912914276, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246422914644604, 'eval_runtime': 3.724, 'eval_samples_per_second': 204.079, 'eval_steps_per_second': 25.51, 'epoch': 2.11}
{'loss': 0.3305, 'grad_norm': 55.911434173583984, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.4185866415500641, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9086209642279838, 'eval_runtime': 3.6909, 'eval_samples_per_second': 205.91, 'eval_steps_per_second': 25.739, 'epoch': 2.34}
{'eval_loss': 0.3570261001586914, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9059245958994647, 'eval_runtime': 3.7233, 'eval_samples_per_second': 204.122, 'eval_steps_per_second': 25.515, 'epoch': 2.57}
{'eval_loss': 0.30358973145484924, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9266921647490072, 'eval_runtime': 3.7858, 'eval_samples_per_second': 200.75, 'eval_steps_per_second': 25.094, 'epoch': 2.81}
{'loss': 0.299, 'grad_norm': 44.943695068359375, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.3722645938396454, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9188587105176332, 'eval_runtime': 3.7253, 'eval_samples_per_second': 204.012, 'eval_steps_per_second': 25.502, 'epoch': 3.04}
{'eval_loss': 0.36393776535987854, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9254576499728855, 'eval_runtime': 3.7332, 'eval_samples_per_second': 203.577, 'eval_steps_per_second': 25.447, 'epoch': 3.27}
{'loss': 0.2604, 'grad_norm': 9.175203323364258, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.3839931786060333, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9165707807377339, 'eval_runtime': 3.7047, 'eval_samples_per_second': 205.146, 'eval_steps_per_second': 25.643, 'epoch': 3.51}
{'eval_loss': 0.41293472051620483, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206476855985253, 'eval_runtime': 3.7182, 'eval_samples_per_second': 204.399, 'eval_steps_per_second': 25.55, 'epoch': 3.74}
{'eval_loss': 0.3640173673629761, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9118381048847233, 'eval_runtime': 3.7198, 'eval_samples_per_second': 204.31, 'eval_steps_per_second': 25.539, 'epoch': 3.98}
{'loss': 0.2301, 'grad_norm': 0.07156466692686081, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.40155836939811707, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9153369367667455, 'eval_runtime': 3.7298, 'eval_samples_per_second': 203.764, 'eval_steps_per_second': 25.471, 'epoch': 4.21}
{'eval_loss': 0.324252188205719, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9220913258703873, 'eval_runtime': 3.7024, 'eval_samples_per_second': 205.272, 'eval_steps_per_second': 25.659, 'epoch': 4.44}
{'loss': 0.1791, 'grad_norm': 11.662851333618164, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.36826300621032715, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.923570169550517, 'eval_runtime': 3.7069, 'eval_samples_per_second': 205.024, 'eval_steps_per_second': 25.628, 'epoch': 4.68}
{'eval_loss': 0.3760106861591339, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9254699354881336, 'eval_runtime': 3.7409, 'eval_samples_per_second': 203.159, 'eval_steps_per_second': 25.395, 'epoch': 4.91}
{'eval_loss': 0.39252978563308716, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9261247984802066, 'eval_runtime': 3.7013, 'eval_samples_per_second': 205.336, 'eval_steps_per_second': 25.667, 'epoch': 5.15}
{'loss': 0.1905, 'grad_norm': 0.04638556018471718, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.31847912073135376, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.926108193322902, 'eval_runtime': 3.7119, 'eval_samples_per_second': 204.748, 'eval_steps_per_second': 25.594, 'epoch': 5.38}
{'eval_loss': 0.4409121870994568, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9143871545881127, 'eval_runtime': 3.6952, 'eval_samples_per_second': 205.674, 'eval_steps_per_second': 25.709, 'epoch': 5.61}
{'loss': 0.1518, 'grad_norm': 0.19766029715538025, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.3865898549556732, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9178340348229519, 'eval_runtime': 3.6685, 'eval_samples_per_second': 207.17, 'eval_steps_per_second': 25.896, 'epoch': 5.85}
{'eval_loss': 0.3822827935218811, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.922389151077038, 'eval_runtime': 3.7209, 'eval_samples_per_second': 204.249, 'eval_steps_per_second': 25.531, 'epoch': 6.08}
{'eval_loss': 0.4512392580509186, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9182009425789637, 'eval_runtime': 3.7353, 'eval_samples_per_second': 203.466, 'eval_steps_per_second': 25.433, 'epoch': 6.32}
{'loss': 0.129, 'grad_norm': 0.13957579433918, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.4475756883621216, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9232490921269694, 'eval_runtime': 3.7338, 'eval_samples_per_second': 203.547, 'eval_steps_per_second': 25.443, 'epoch': 6.55}
{'eval_loss': 0.3607763946056366, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9314243479966267, 'eval_runtime': 3.6859, 'eval_samples_per_second': 206.192, 'eval_steps_per_second': 25.774, 'epoch': 6.78}
{'loss': 0.1199, 'grad_norm': 0.03342178091406822, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.4798993468284607, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9193717427642756, 'eval_runtime': 3.6848, 'eval_samples_per_second': 206.252, 'eval_steps_per_second': 25.781, 'epoch': 7.02}
{'eval_loss': 0.4409421384334564, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9257311238087529, 'eval_runtime': 3.7152, 'eval_samples_per_second': 204.565, 'eval_steps_per_second': 25.571, 'epoch': 7.25}
{'eval_loss': 0.42519018054008484, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9275707719019042, 'eval_runtime': 3.6927, 'eval_samples_per_second': 205.809, 'eval_steps_per_second': 25.726, 'epoch': 7.49}
{'loss': 0.0909, 'grad_norm': 3.685469150543213, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.46821343898773193, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.925960447428201, 'eval_runtime': 3.6931, 'eval_samples_per_second': 205.791, 'eval_steps_per_second': 25.724, 'epoch': 7.72}
{'eval_loss': 0.3929591178894043, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9325692217623054, 'eval_runtime': 3.7074, 'eval_samples_per_second': 204.993, 'eval_steps_per_second': 25.624, 'epoch': 7.95}
{'loss': 0.08, 'grad_norm': 0.06961275637149811, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.38408976793289185, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9327090854485637, 'eval_runtime': 3.7344, 'eval_samples_per_second': 203.511, 'eval_steps_per_second': 25.439, 'epoch': 8.19}
{'eval_loss': 0.4209801256656647, 'eval_accuracy': 0.9302631578947368, 'eval_micro_f1': 0.9302631578947368, 'eval_macro_f1': 0.9284384027266925, 'eval_runtime': 3.7581, 'eval_samples_per_second': 202.232, 'eval_steps_per_second': 25.279, 'epoch': 8.42}
{'eval_loss': 0.44755619764328003, 'eval_accuracy': 0.9328947368421052, 'eval_micro_f1': 0.9328947368421052, 'eval_macro_f1': 0.9311186243780898, 'eval_runtime': 3.7479, 'eval_samples_per_second': 202.781, 'eval_steps_per_second': 25.348, 'epoch': 8.65}
{'loss': 0.0645, 'grad_norm': 0.25569650530815125, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.46471107006073, 'eval_accuracy': 0.9302631578947368, 'eval_micro_f1': 0.9302631578947368, 'eval_macro_f1': 0.9283892757351662, 'eval_runtime': 3.7437, 'eval_samples_per_second': 203.009, 'eval_steps_per_second': 25.376, 'epoch': 8.89}
{'eval_loss': 0.4242420494556427, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9326160668072432, 'eval_runtime': 3.7686, 'eval_samples_per_second': 201.665, 'eval_steps_per_second': 25.208, 'epoch': 9.12}
{'loss': 0.0557, 'grad_norm': 0.2009422928094864, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.4416927099227905, 'eval_accuracy': 0.9355263157894737, 'eval_micro_f1': 0.9355263157894737, 'eval_macro_f1': 0.9338445746606692, 'eval_runtime': 3.6992, 'eval_samples_per_second': 205.448, 'eval_steps_per_second': 25.681, 'epoch': 9.36}
{'eval_loss': 0.4627712368965149, 'eval_accuracy': 0.9342105263157895, 'eval_micro_f1': 0.9342105263157895, 'eval_macro_f1': 0.9325306662435827, 'eval_runtime': 3.7288, 'eval_samples_per_second': 203.817, 'eval_steps_per_second': 25.477, 'epoch': 9.59}
{'eval_loss': 0.4624835252761841, 'eval_accuracy': 0.9315789473684211, 'eval_micro_f1': 0.9315789473684211, 'eval_macro_f1': 0.9298703868991538, 'eval_runtime': 3.7325, 'eval_samples_per_second': 203.618, 'eval_steps_per_second': 25.452, 'epoch': 9.82}
{'loss': 0.0358, 'grad_norm': 374.7314147949219, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1503.9265, 'train_samples_per_second': 45.481, 'train_steps_per_second': 5.685, 'train_loss': 0.20872702031107673, 'epoch': 10.0}
