/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 7776.72 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 7693.37 examples/s]
model.safetensors:   9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                              | 41.9M/442M [00:01<00:12, 32.5MB/s]/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
model.safetensors: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 442M/442M [01:48<00:00, 4.07MB/s]
                                                                                                                                                                    
                                                                                                                                                                    
{'eval_loss': 0.4942646920681, 'eval_accuracy': 0.875, 'eval_micro_f1': 0.875, 'eval_macro_f1': 0.8729553866592696, 'eval_runtime': 4.171, 'eval_samples_per_second': 182.21, 'eval_steps_per_second': 22.776, 'epoch': 0.23}
{'eval_loss': 0.43214118480682373, 'eval_accuracy': 0.8736842105263158, 'eval_micro_f1': 0.8736842105263158, 'eval_macro_f1': 0.8726628369074108, 'eval_runtime': 4.1649, 'eval_samples_per_second': 182.475, 'eval_steps_per_second': 22.809, 'epoch': 0.47}
{'loss': 0.6029, 'grad_norm': 1.202524185180664, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.38355037569999695, 'eval_accuracy': 0.8789473684210526, 'eval_micro_f1': 0.8789473684210526, 'eval_macro_f1': 0.8765486428901278, 'eval_runtime': 4.0995, 'eval_samples_per_second': 185.39, 'eval_steps_per_second': 23.174, 'epoch': 0.7}
{'eval_loss': 0.36523622274398804, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.895046979036458, 'eval_runtime': 4.0875, 'eval_samples_per_second': 185.931, 'eval_steps_per_second': 23.241, 'epoch': 0.94}
{'loss': 0.4737, 'grad_norm': 5.592627048492432, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.5243293642997742, 'eval_accuracy': 0.8894736842105263, 'eval_micro_f1': 0.8894736842105263, 'eval_macro_f1': 0.8871759670573767, 'eval_runtime': 4.1081, 'eval_samples_per_second': 185.001, 'eval_steps_per_second': 23.125, 'epoch': 1.17}
{'eval_loss': 0.41674771904945374, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.901162383235566, 'eval_runtime': 4.0761, 'eval_samples_per_second': 186.452, 'eval_steps_per_second': 23.307, 'epoch': 1.4}
{'eval_loss': 0.4576190412044525, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.8956841238589592, 'eval_runtime': 4.1451, 'eval_samples_per_second': 183.348, 'eval_steps_per_second': 22.918, 'epoch': 1.64}
{'loss': 0.396, 'grad_norm': 22.183704376220703, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3590734302997589, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089866015522654, 'eval_runtime': 4.1861, 'eval_samples_per_second': 181.553, 'eval_steps_per_second': 22.694, 'epoch': 1.87}
{'eval_loss': 0.4226562976837158, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9065038632233025, 'eval_runtime': 4.1594, 'eval_samples_per_second': 182.718, 'eval_steps_per_second': 22.84, 'epoch': 2.11}
{'loss': 0.2962, 'grad_norm': 4.242546558380127, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.5018460154533386, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8945341660894879, 'eval_runtime': 4.0842, 'eval_samples_per_second': 186.082, 'eval_steps_per_second': 23.26, 'epoch': 2.34}
{'eval_loss': 0.47794297337532043, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8978676831557365, 'eval_runtime': 4.1589, 'eval_samples_per_second': 182.742, 'eval_steps_per_second': 22.843, 'epoch': 2.57}
{'eval_loss': 0.44557222723960876, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9074226988660251, 'eval_runtime': 4.0874, 'eval_samples_per_second': 185.936, 'eval_steps_per_second': 23.242, 'epoch': 2.81}
{'loss': 0.2825, 'grad_norm': 4.705611705780029, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.44803500175476074, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9085271066542933, 'eval_runtime': 4.1443, 'eval_samples_per_second': 183.386, 'eval_steps_per_second': 22.923, 'epoch': 3.04}
{'eval_loss': 0.5402993559837341, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9043969243710427, 'eval_runtime': 4.1432, 'eval_samples_per_second': 183.434, 'eval_steps_per_second': 22.929, 'epoch': 3.27}
{'loss': 0.1916, 'grad_norm': 0.12186618894338608, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.5564286708831787, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9018478681430718, 'eval_runtime': 4.1005, 'eval_samples_per_second': 185.345, 'eval_steps_per_second': 23.168, 'epoch': 3.51}
{'eval_loss': 0.5251957178115845, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9020558142047285, 'eval_runtime': 4.1755, 'eval_samples_per_second': 182.013, 'eval_steps_per_second': 22.752, 'epoch': 3.74}
{'eval_loss': 0.420758455991745, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114449118667993, 'eval_runtime': 4.1631, 'eval_samples_per_second': 182.555, 'eval_steps_per_second': 22.819, 'epoch': 3.98}
{'loss': 0.1527, 'grad_norm': 0.025987721979618073, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.5562556385993958, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9090201189693898, 'eval_runtime': 4.0702, 'eval_samples_per_second': 186.723, 'eval_steps_per_second': 23.34, 'epoch': 4.21}
{'eval_loss': 0.4844665825366974, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.8999899955605952, 'eval_runtime': 4.0673, 'eval_samples_per_second': 186.858, 'eval_steps_per_second': 23.357, 'epoch': 4.44}
{'loss': 0.1164, 'grad_norm': 0.05885973572731018, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.4880611300468445, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9056533245312938, 'eval_runtime': 4.06, 'eval_samples_per_second': 187.194, 'eval_steps_per_second': 23.399, 'epoch': 4.68}
{'eval_loss': 0.5773007869720459, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.9007021040832531, 'eval_runtime': 4.1456, 'eval_samples_per_second': 183.325, 'eval_steps_per_second': 22.916, 'epoch': 4.91}
{'eval_loss': 0.6115136742591858, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9056485945769825, 'eval_runtime': 4.1319, 'eval_samples_per_second': 183.935, 'eval_steps_per_second': 22.992, 'epoch': 5.15}
{'loss': 0.117, 'grad_norm': 0.015459742397069931, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.6292210817337036, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.8995089026621595, 'eval_runtime': 4.0857, 'eval_samples_per_second': 186.015, 'eval_steps_per_second': 23.252, 'epoch': 5.38}
{'eval_loss': 0.669117271900177, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8976085043447637, 'eval_runtime': 4.0187, 'eval_samples_per_second': 189.118, 'eval_steps_per_second': 23.64, 'epoch': 5.61}
{'loss': 0.0786, 'grad_norm': 0.6110740900039673, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.606071949005127, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.9036348453820829, 'eval_runtime': 4.1222, 'eval_samples_per_second': 184.369, 'eval_steps_per_second': 23.046, 'epoch': 5.85}
{'eval_loss': 0.5991500020027161, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.908983332604896, 'eval_runtime': 4.074, 'eval_samples_per_second': 186.551, 'eval_steps_per_second': 23.319, 'epoch': 6.08}
{'eval_loss': 0.6716392636299133, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.903061426467855, 'eval_runtime': 4.0743, 'eval_samples_per_second': 186.536, 'eval_steps_per_second': 23.317, 'epoch': 6.32}
{'loss': 0.0427, 'grad_norm': 0.006170386914163828, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.7473794221878052, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8979164405684316, 'eval_runtime': 4.1308, 'eval_samples_per_second': 183.984, 'eval_steps_per_second': 22.998, 'epoch': 6.55}
{'eval_loss': 0.6988388895988464, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9052041039188291, 'eval_runtime': 4.0824, 'eval_samples_per_second': 186.165, 'eval_steps_per_second': 23.271, 'epoch': 6.78}
{'loss': 0.0342, 'grad_norm': 0.006444311700761318, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.7292880415916443, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9078407880443006, 'eval_runtime': 4.0778, 'eval_samples_per_second': 186.374, 'eval_steps_per_second': 23.297, 'epoch': 7.02}
{'eval_loss': 0.6735018491744995, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9076879124284488, 'eval_runtime': 4.0813, 'eval_samples_per_second': 186.217, 'eval_steps_per_second': 23.277, 'epoch': 7.25}
{'eval_loss': 0.7258808612823486, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9045198671429799, 'eval_runtime': 4.0714, 'eval_samples_per_second': 186.666, 'eval_steps_per_second': 23.333, 'epoch': 7.49}
{'loss': 0.0204, 'grad_norm': 0.3291414976119995, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.7265001535415649, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9103198317275846, 'eval_runtime': 4.0884, 'eval_samples_per_second': 185.892, 'eval_steps_per_second': 23.236, 'epoch': 7.72}
{'eval_loss': 0.720085084438324, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9142808261610426, 'eval_runtime': 4.1364, 'eval_samples_per_second': 183.734, 'eval_steps_per_second': 22.967, 'epoch': 7.95}
{'loss': 0.0087, 'grad_norm': 0.011905213817954063, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.803870439529419, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.8993774484712914, 'eval_runtime': 4.0974, 'eval_samples_per_second': 185.482, 'eval_steps_per_second': 23.185, 'epoch': 8.19}
{'eval_loss': 0.7417110204696655, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9117269532992052, 'eval_runtime': 4.1255, 'eval_samples_per_second': 184.22, 'eval_steps_per_second': 23.027, 'epoch': 8.42}
{'eval_loss': 0.7801356315612793, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9073950996696171, 'eval_runtime': 4.11, 'eval_samples_per_second': 184.913, 'eval_steps_per_second': 23.114, 'epoch': 8.65}
{'loss': 0.0039, 'grad_norm': 0.0014913524501025677, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.7278768420219421, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9156664606216371, 'eval_runtime': 4.0688, 'eval_samples_per_second': 186.787, 'eval_steps_per_second': 23.348, 'epoch': 8.89}
{'eval_loss': 0.7549514174461365, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9115441404923699, 'eval_runtime': 4.0827, 'eval_samples_per_second': 186.15, 'eval_steps_per_second': 23.269, 'epoch': 9.12}
{'loss': 0.0062, 'grad_norm': 0.0014201184967532754, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.7643435597419739, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114490786480495, 'eval_runtime': 4.0924, 'eval_samples_per_second': 185.708, 'eval_steps_per_second': 23.214, 'epoch': 9.36}
{'eval_loss': 0.7478623390197754, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.912925586877064, 'eval_runtime': 4.1295, 'eval_samples_per_second': 184.043, 'eval_steps_per_second': 23.005, 'epoch': 9.59}
{'eval_loss': 0.7361188530921936, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9142685239830654, 'eval_runtime': 4.1469, 'eval_samples_per_second': 183.268, 'eval_steps_per_second': 22.909, 'epoch': 9.82}
{'loss': 0.0058, 'grad_norm': 0.0013712956570088863, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1694.2848, 'train_samples_per_second': 40.371, 'train_steps_per_second': 5.046, 'train_loss': 0.1654713152009144, 'epoch': 10.0}
