/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 7074.13 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 7261.69 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                    
                                                                                                                                                                    
{'eval_loss': 0.3769665062427521, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9069680080112801, 'eval_runtime': 4.231, 'eval_samples_per_second': 179.628, 'eval_steps_per_second': 22.454, 'epoch': 0.23}
{'eval_loss': 0.30432870984077454, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114287740138466, 'eval_runtime': 4.1355, 'eval_samples_per_second': 183.773, 'eval_steps_per_second': 22.972, 'epoch': 0.47}
{'loss': 0.4706, 'grad_norm': 0.3781434893608093, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.28983360528945923, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246317458099629, 'eval_runtime': 4.1441, 'eval_samples_per_second': 183.395, 'eval_steps_per_second': 22.924, 'epoch': 0.7}
{'eval_loss': 0.31339913606643677, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9155226123227622, 'eval_runtime': 4.2165, 'eval_samples_per_second': 180.246, 'eval_steps_per_second': 22.531, 'epoch': 0.94}
{'loss': 0.3589, 'grad_norm': 0.2281433343887329, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.4202900230884552, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088978067837581, 'eval_runtime': 4.1318, 'eval_samples_per_second': 183.94, 'eval_steps_per_second': 22.992, 'epoch': 1.17}
{'eval_loss': 0.42071548104286194, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9137459228599503, 'eval_runtime': 4.1884, 'eval_samples_per_second': 181.453, 'eval_steps_per_second': 22.682, 'epoch': 1.4}
{'eval_loss': 0.31823980808258057, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9197656670596769, 'eval_runtime': 4.2415, 'eval_samples_per_second': 179.184, 'eval_steps_per_second': 22.398, 'epoch': 1.64}
{'loss': 0.2904, 'grad_norm': 5.328208923339844, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.31191080808639526, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9116724454103625, 'eval_runtime': 4.224, 'eval_samples_per_second': 179.923, 'eval_steps_per_second': 22.49, 'epoch': 1.87}
{'eval_loss': 0.3964275121688843, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.91443434916798, 'eval_runtime': 4.2079, 'eval_samples_per_second': 180.613, 'eval_steps_per_second': 22.577, 'epoch': 2.11}
{'loss': 0.2183, 'grad_norm': 19.70903968811035, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.43661925196647644, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9112612549099885, 'eval_runtime': 4.0563, 'eval_samples_per_second': 187.365, 'eval_steps_per_second': 23.421, 'epoch': 2.34}
{'eval_loss': 0.3878495395183563, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9234007469451511, 'eval_runtime': 4.0752, 'eval_samples_per_second': 186.496, 'eval_steps_per_second': 23.312, 'epoch': 2.57}
{'eval_loss': 0.44372138381004333, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206004716152317, 'eval_runtime': 4.2651, 'eval_samples_per_second': 178.19, 'eval_steps_per_second': 22.274, 'epoch': 2.81}
{'loss': 0.1778, 'grad_norm': 37.14847183227539, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.36294257640838623, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9207987716065206, 'eval_runtime': 4.1462, 'eval_samples_per_second': 183.299, 'eval_steps_per_second': 22.912, 'epoch': 3.04}
{'eval_loss': 0.4571821391582489, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9151310943422705, 'eval_runtime': 4.0821, 'eval_samples_per_second': 186.18, 'eval_steps_per_second': 23.272, 'epoch': 3.27}
{'loss': 0.1125, 'grad_norm': 0.13151931762695312, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.487283319234848, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9204151429938295, 'eval_runtime': 4.1862, 'eval_samples_per_second': 181.55, 'eval_steps_per_second': 22.694, 'epoch': 3.51}
{'eval_loss': 0.416216641664505, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9202254698673977, 'eval_runtime': 4.1605, 'eval_samples_per_second': 182.67, 'eval_steps_per_second': 22.834, 'epoch': 3.74}
{'eval_loss': 0.42115357518196106, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9152006619111882, 'eval_runtime': 4.1922, 'eval_samples_per_second': 181.288, 'eval_steps_per_second': 22.661, 'epoch': 3.98}
{'loss': 0.1078, 'grad_norm': 0.005475066136568785, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.554470956325531, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9161787542924208, 'eval_runtime': 4.1776, 'eval_samples_per_second': 181.923, 'eval_steps_per_second': 22.74, 'epoch': 4.21}
{'eval_loss': 0.5530614852905273, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9107966918414641, 'eval_runtime': 4.169, 'eval_samples_per_second': 182.298, 'eval_steps_per_second': 22.787, 'epoch': 4.44}
{'loss': 0.0486, 'grad_norm': 0.01585172675549984, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.5345169305801392, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.913609984515833, 'eval_runtime': 4.2047, 'eval_samples_per_second': 180.75, 'eval_steps_per_second': 22.594, 'epoch': 4.68}
{'eval_loss': 0.5189602375030518, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9141295005360169, 'eval_runtime': 4.169, 'eval_samples_per_second': 182.296, 'eval_steps_per_second': 22.787, 'epoch': 4.91}
{'eval_loss': 0.5125551819801331, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9247029353377877, 'eval_runtime': 4.1516, 'eval_samples_per_second': 183.063, 'eval_steps_per_second': 22.883, 'epoch': 5.15}
{'loss': 0.0361, 'grad_norm': 0.00392478983849287, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.5477572083473206, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9207101464718238, 'eval_runtime': 4.1706, 'eval_samples_per_second': 182.227, 'eval_steps_per_second': 22.778, 'epoch': 5.38}
{'eval_loss': 0.5997464656829834, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9178739271462537, 'eval_runtime': 4.1618, 'eval_samples_per_second': 182.611, 'eval_steps_per_second': 22.826, 'epoch': 5.61}
{'loss': 0.0236, 'grad_norm': 0.01686115376651287, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.5908006429672241, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9253865411399658, 'eval_runtime': 4.1365, 'eval_samples_per_second': 183.732, 'eval_steps_per_second': 22.966, 'epoch': 5.85}
{'eval_loss': 0.5884960889816284, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233348380481241, 'eval_runtime': 4.149, 'eval_samples_per_second': 183.175, 'eval_steps_per_second': 22.897, 'epoch': 6.08}
{'eval_loss': 0.5949824452400208, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9232382712354499, 'eval_runtime': 4.1342, 'eval_samples_per_second': 183.834, 'eval_steps_per_second': 22.979, 'epoch': 6.32}
{'loss': 0.0203, 'grad_norm': 0.0017634861869737506, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.6053158640861511, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9242606260022553, 'eval_runtime': 4.1681, 'eval_samples_per_second': 182.339, 'eval_steps_per_second': 22.792, 'epoch': 6.55}
{'eval_loss': 0.5850554704666138, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259759695647264, 'eval_runtime': 4.1693, 'eval_samples_per_second': 182.285, 'eval_steps_per_second': 22.786, 'epoch': 6.78}
{'loss': 0.0167, 'grad_norm': 0.010705738328397274, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.5746397376060486, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9256501666713458, 'eval_runtime': 4.1458, 'eval_samples_per_second': 183.319, 'eval_steps_per_second': 22.915, 'epoch': 7.02}
{'eval_loss': 0.6120091676712036, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258318916517015, 'eval_runtime': 4.1286, 'eval_samples_per_second': 184.082, 'eval_steps_per_second': 23.01, 'epoch': 7.25}
{'eval_loss': 0.6305036544799805, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9270802268376233, 'eval_runtime': 4.1322, 'eval_samples_per_second': 183.921, 'eval_steps_per_second': 22.99, 'epoch': 7.49}
{'loss': 0.0142, 'grad_norm': 0.0025391802191734314, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.6206346154212952, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9218315872284095, 'eval_runtime': 4.1093, 'eval_samples_per_second': 184.945, 'eval_steps_per_second': 23.118, 'epoch': 7.72}
{'eval_loss': 0.6556127071380615, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243665778305581, 'eval_runtime': 4.1363, 'eval_samples_per_second': 183.738, 'eval_steps_per_second': 22.967, 'epoch': 7.95}
{'loss': 0.0034, 'grad_norm': 0.0014765015803277493, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.6841904520988464, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9242751080508284, 'eval_runtime': 4.1914, 'eval_samples_per_second': 181.324, 'eval_steps_per_second': 22.666, 'epoch': 8.19}
{'eval_loss': 0.6882081627845764, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243673453335822, 'eval_runtime': 4.2513, 'eval_samples_per_second': 178.77, 'eval_steps_per_second': 22.346, 'epoch': 8.42}
{'eval_loss': 0.6954668760299683, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243673453335822, 'eval_runtime': 4.2567, 'eval_samples_per_second': 178.542, 'eval_steps_per_second': 22.318, 'epoch': 8.65}
{'loss': 0.0001, 'grad_norm': 0.0007142971153371036, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.664441704750061, 'eval_accuracy': 0.9315789473684211, 'eval_micro_f1': 0.9315789473684211, 'eval_macro_f1': 0.929920898324435, 'eval_runtime': 4.1108, 'eval_samples_per_second': 184.878, 'eval_steps_per_second': 23.11, 'epoch': 8.89}
{'eval_loss': 0.6748983263969421, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259374152851632, 'eval_runtime': 4.2707, 'eval_samples_per_second': 177.958, 'eval_steps_per_second': 22.245, 'epoch': 9.12}
{'loss': 0.0024, 'grad_norm': 0.0020659316796809435, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.6877641081809998, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.1168, 'eval_samples_per_second': 184.608, 'eval_steps_per_second': 23.076, 'epoch': 9.36}
{'eval_loss': 0.6870204210281372, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.1576, 'eval_samples_per_second': 182.797, 'eval_steps_per_second': 22.85, 'epoch': 9.59}
{'eval_loss': 0.6852336525917053, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.1426, 'eval_samples_per_second': 183.458, 'eval_steps_per_second': 22.932, 'epoch': 9.82}
{'loss': 0.001, 'grad_norm': 0.003695489140227437, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1687.4017, 'train_samples_per_second': 40.536, 'train_steps_per_second': 5.067, 'train_loss': 0.11126542986109199, 'epoch': 10.0}
