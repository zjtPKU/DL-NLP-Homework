/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 13304.86 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 12227.45 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.4942646920681, 'eval_accuracy': 0.875, 'eval_micro_f1': 0.875, 'eval_macro_f1': 0.8729553866592696, 'eval_runtime': 4.007, 'eval_samples_per_second': 189.67, 'eval_steps_per_second': 23.709, 'epoch': 0.23}
{'eval_loss': 0.43214118480682373, 'eval_accuracy': 0.8736842105263158, 'eval_micro_f1': 0.8736842105263158, 'eval_macro_f1': 0.8726628369074108, 'eval_runtime': 3.9777, 'eval_samples_per_second': 191.063, 'eval_steps_per_second': 23.883, 'epoch': 0.47}
{'loss': 0.6029, 'grad_norm': 1.202524185180664, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.38355037569999695, 'eval_accuracy': 0.8789473684210526, 'eval_micro_f1': 0.8789473684210526, 'eval_macro_f1': 0.8765486428901278, 'eval_runtime': 3.9542, 'eval_samples_per_second': 192.201, 'eval_steps_per_second': 24.025, 'epoch': 0.7}
{'eval_loss': 0.36523622274398804, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.895046979036458, 'eval_runtime': 3.9579, 'eval_samples_per_second': 192.02, 'eval_steps_per_second': 24.002, 'epoch': 0.94}
{'loss': 0.4737, 'grad_norm': 5.592627048492432, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.5243293642997742, 'eval_accuracy': 0.8894736842105263, 'eval_micro_f1': 0.8894736842105263, 'eval_macro_f1': 0.8871759670573767, 'eval_runtime': 3.8951, 'eval_samples_per_second': 195.115, 'eval_steps_per_second': 24.389, 'epoch': 1.17}
{'eval_loss': 0.41674771904945374, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.901162383235566, 'eval_runtime': 3.9449, 'eval_samples_per_second': 192.655, 'eval_steps_per_second': 24.082, 'epoch': 1.4}
{'eval_loss': 0.4576190412044525, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.8956841238589592, 'eval_runtime': 3.9742, 'eval_samples_per_second': 191.232, 'eval_steps_per_second': 23.904, 'epoch': 1.64}
{'loss': 0.396, 'grad_norm': 22.183704376220703, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3590734302997589, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089866015522654, 'eval_runtime': 3.9249, 'eval_samples_per_second': 193.635, 'eval_steps_per_second': 24.204, 'epoch': 1.87}
{'eval_loss': 0.4226562976837158, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9065038632233025, 'eval_runtime': 3.9873, 'eval_samples_per_second': 190.606, 'eval_steps_per_second': 23.826, 'epoch': 2.11}
{'loss': 0.2962, 'grad_norm': 4.242546558380127, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.5018460154533386, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8945341660894879, 'eval_runtime': 3.9397, 'eval_samples_per_second': 192.91, 'eval_steps_per_second': 24.114, 'epoch': 2.34}
{'eval_loss': 0.47794297337532043, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8978676831557365, 'eval_runtime': 3.9675, 'eval_samples_per_second': 191.556, 'eval_steps_per_second': 23.945, 'epoch': 2.57}
{'eval_loss': 0.44557222723960876, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9074226988660251, 'eval_runtime': 3.9197, 'eval_samples_per_second': 193.891, 'eval_steps_per_second': 24.236, 'epoch': 2.81}
{'loss': 0.2825, 'grad_norm': 4.705611705780029, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.44803500175476074, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9085271066542933, 'eval_runtime': 3.9504, 'eval_samples_per_second': 192.386, 'eval_steps_per_second': 24.048, 'epoch': 3.04}
{'eval_loss': 0.5402993559837341, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9043969243710427, 'eval_runtime': 3.9549, 'eval_samples_per_second': 192.169, 'eval_steps_per_second': 24.021, 'epoch': 3.27}
{'loss': 0.1916, 'grad_norm': 0.12186618894338608, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.5564286708831787, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9018478681430718, 'eval_runtime': 3.9068, 'eval_samples_per_second': 194.535, 'eval_steps_per_second': 24.317, 'epoch': 3.51}
{'eval_loss': 0.5251957178115845, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9020558142047285, 'eval_runtime': 3.9439, 'eval_samples_per_second': 192.704, 'eval_steps_per_second': 24.088, 'epoch': 3.74}
{'eval_loss': 0.4190445840358734, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088372720642758, 'eval_runtime': 3.9685, 'eval_samples_per_second': 191.506, 'eval_steps_per_second': 23.938, 'epoch': 3.98}
{'loss': 0.1524, 'grad_norm': 0.02285182848572731, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.6058422923088074, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.8958599972585369, 'eval_runtime': 3.9406, 'eval_samples_per_second': 192.864, 'eval_steps_per_second': 24.108, 'epoch': 4.21}
{'eval_loss': 0.4724203944206238, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9139394794232208, 'eval_runtime': 3.9724, 'eval_samples_per_second': 191.319, 'eval_steps_per_second': 23.915, 'epoch': 4.44}
{'loss': 0.1147, 'grad_norm': 0.03487676382064819, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.5411725640296936, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9029196927110013, 'eval_runtime': 3.9273, 'eval_samples_per_second': 193.519, 'eval_steps_per_second': 24.19, 'epoch': 4.68}
{'eval_loss': 0.5508981943130493, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.8997189669290894, 'eval_runtime': 3.9372, 'eval_samples_per_second': 193.031, 'eval_steps_per_second': 24.129, 'epoch': 4.91}
{'eval_loss': 0.5911518931388855, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.914446726707, 'eval_runtime': 3.965, 'eval_samples_per_second': 191.677, 'eval_steps_per_second': 23.96, 'epoch': 5.15}
{'loss': 0.1065, 'grad_norm': 0.020998584106564522, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.569800615310669, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.911982851909041, 'eval_runtime': 3.9375, 'eval_samples_per_second': 193.015, 'eval_steps_per_second': 24.127, 'epoch': 5.38}
{'eval_loss': 0.7439146637916565, 'eval_accuracy': 0.8934210526315789, 'eval_micro_f1': 0.8934210526315789, 'eval_macro_f1': 0.8913540596662922, 'eval_runtime': 3.9687, 'eval_samples_per_second': 191.5, 'eval_steps_per_second': 23.937, 'epoch': 5.61}
{'loss': 0.0809, 'grad_norm': 61.42317199707031, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.6118232607841492, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8982728640320569, 'eval_runtime': 3.8943, 'eval_samples_per_second': 195.158, 'eval_steps_per_second': 24.395, 'epoch': 5.85}
{'eval_loss': 0.5991929173469543, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9104116158880672, 'eval_runtime': 3.9869, 'eval_samples_per_second': 190.624, 'eval_steps_per_second': 23.828, 'epoch': 6.08}
{'eval_loss': 0.6334670782089233, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9019124554675776, 'eval_runtime': 3.9264, 'eval_samples_per_second': 193.564, 'eval_steps_per_second': 24.195, 'epoch': 6.32}
{'loss': 0.0448, 'grad_norm': 0.008964620530605316, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.7223164439201355, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9013000002351963, 'eval_runtime': 4.0161, 'eval_samples_per_second': 189.238, 'eval_steps_per_second': 23.655, 'epoch': 6.55}
{'eval_loss': 0.6866590976715088, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9072935788577503, 'eval_runtime': 3.9453, 'eval_samples_per_second': 192.634, 'eval_steps_per_second': 24.079, 'epoch': 6.78}
{'loss': 0.0354, 'grad_norm': 0.012382758781313896, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.6634588837623596, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9118885591522689, 'eval_runtime': 3.8943, 'eval_samples_per_second': 195.156, 'eval_steps_per_second': 24.394, 'epoch': 7.02}
{'eval_loss': 0.681531548500061, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9116531745775842, 'eval_runtime': 3.9458, 'eval_samples_per_second': 192.609, 'eval_steps_per_second': 24.076, 'epoch': 7.25}
{'eval_loss': 0.640432596206665, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9129262087539182, 'eval_runtime': 4.0096, 'eval_samples_per_second': 189.546, 'eval_steps_per_second': 23.693, 'epoch': 7.49}
{'loss': 0.0234, 'grad_norm': 0.10914464294910431, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.6419834494590759, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9181811462709882, 'eval_runtime': 3.9687, 'eval_samples_per_second': 191.497, 'eval_steps_per_second': 23.937, 'epoch': 7.72}
{'eval_loss': 0.7372252345085144, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9057300836158209, 'eval_runtime': 3.9787, 'eval_samples_per_second': 191.017, 'eval_steps_per_second': 23.877, 'epoch': 7.95}
{'loss': 0.0057, 'grad_norm': 0.0027466362807899714, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.8016007542610168, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9018821736636061, 'eval_runtime': 3.9217, 'eval_samples_per_second': 193.791, 'eval_steps_per_second': 24.224, 'epoch': 8.19}
{'eval_loss': 0.7412009835243225, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9140273930440136, 'eval_runtime': 4.0408, 'eval_samples_per_second': 188.081, 'eval_steps_per_second': 23.51, 'epoch': 8.42}
{'eval_loss': 0.7666849493980408, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9075048910439448, 'eval_runtime': 3.9924, 'eval_samples_per_second': 190.363, 'eval_steps_per_second': 23.795, 'epoch': 8.65}
{'loss': 0.0034, 'grad_norm': 0.00182947120629251, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.7584723830223083, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9100379655313569, 'eval_runtime': 3.9283, 'eval_samples_per_second': 193.47, 'eval_steps_per_second': 24.184, 'epoch': 8.89}
{'eval_loss': 0.7573432326316833, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088883600121577, 'eval_runtime': 3.9622, 'eval_samples_per_second': 191.812, 'eval_steps_per_second': 23.976, 'epoch': 9.12}
{'loss': 0.0077, 'grad_norm': 0.0024116444401443005, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.7827306389808655, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9073875667893604, 'eval_runtime': 3.9152, 'eval_samples_per_second': 194.114, 'eval_steps_per_second': 24.264, 'epoch': 9.36}
{'eval_loss': 0.7715620398521423, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9073875667893604, 'eval_runtime': 3.9459, 'eval_samples_per_second': 192.605, 'eval_steps_per_second': 24.076, 'epoch': 9.59}
{'eval_loss': 0.768583357334137, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9100150422940186, 'eval_runtime': 4.0025, 'eval_samples_per_second': 189.883, 'eval_steps_per_second': 23.735, 'epoch': 9.82}
{'loss': 0.0047, 'grad_norm': 0.0031821904703974724, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1493.2656, 'train_samples_per_second': 45.806, 'train_steps_per_second': 5.726, 'train_loss': 0.1650563769564795, 'epoch': 10.0}
