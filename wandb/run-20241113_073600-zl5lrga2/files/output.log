/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 7428.61 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 5311.57 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.3769665062427521, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9069680080112801, 'eval_runtime': 4.1539, 'eval_samples_per_second': 182.959, 'eval_steps_per_second': 22.87, 'epoch': 0.23}
{'eval_loss': 0.30432870984077454, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114287740138466, 'eval_runtime': 4.2771, 'eval_samples_per_second': 177.689, 'eval_steps_per_second': 22.211, 'epoch': 0.47}
{'loss': 0.4706, 'grad_norm': 0.3781434893608093, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.28983360528945923, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246317458099629, 'eval_runtime': 4.0698, 'eval_samples_per_second': 186.74, 'eval_steps_per_second': 23.343, 'epoch': 0.7}
{'eval_loss': 0.31339913606643677, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9155226123227622, 'eval_runtime': 4.159, 'eval_samples_per_second': 182.735, 'eval_steps_per_second': 22.842, 'epoch': 0.94}
{'loss': 0.3589, 'grad_norm': 0.2281433343887329, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.4202900230884552, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088978067837581, 'eval_runtime': 4.0673, 'eval_samples_per_second': 186.857, 'eval_steps_per_second': 23.357, 'epoch': 1.17}
{'eval_loss': 0.42071548104286194, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9137459228599503, 'eval_runtime': 4.0383, 'eval_samples_per_second': 188.196, 'eval_steps_per_second': 23.525, 'epoch': 1.4}
{'eval_loss': 0.31823980808258057, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9197656670596769, 'eval_runtime': 4.1514, 'eval_samples_per_second': 183.07, 'eval_steps_per_second': 22.884, 'epoch': 1.64}
{'loss': 0.2904, 'grad_norm': 5.328208923339844, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.31191080808639526, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9116724454103625, 'eval_runtime': 4.11, 'eval_samples_per_second': 184.914, 'eval_steps_per_second': 23.114, 'epoch': 1.87}
{'eval_loss': 0.3964275121688843, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.91443434916798, 'eval_runtime': 4.3936, 'eval_samples_per_second': 172.978, 'eval_steps_per_second': 21.622, 'epoch': 2.11}
{'loss': 0.2183, 'grad_norm': 19.358633041381836, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.43542537093162537, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9112612549099885, 'eval_runtime': 4.0995, 'eval_samples_per_second': 185.387, 'eval_steps_per_second': 23.173, 'epoch': 2.34}
{'eval_loss': 0.3497208058834076, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9260559697964228, 'eval_runtime': 4.3478, 'eval_samples_per_second': 174.803, 'eval_steps_per_second': 21.85, 'epoch': 2.57}
{'eval_loss': 0.4149351418018341, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9141203789328368, 'eval_runtime': 4.2205, 'eval_samples_per_second': 180.074, 'eval_steps_per_second': 22.509, 'epoch': 2.81}
{'loss': 0.1755, 'grad_norm': 0.03969196602702141, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.40740564465522766, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9115851386300386, 'eval_runtime': 4.1124, 'eval_samples_per_second': 184.805, 'eval_steps_per_second': 23.101, 'epoch': 3.04}
{'eval_loss': 0.5135888457298279, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9191066256910143, 'eval_runtime': 4.3128, 'eval_samples_per_second': 176.22, 'eval_steps_per_second': 22.027, 'epoch': 3.27}
{'loss': 0.1172, 'grad_norm': 0.06417956948280334, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.45148661732673645, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9218287048156157, 'eval_runtime': 4.0832, 'eval_samples_per_second': 186.13, 'eval_steps_per_second': 23.266, 'epoch': 3.51}
{'eval_loss': 0.4365484118461609, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9092308577462453, 'eval_runtime': 4.0866, 'eval_samples_per_second': 185.972, 'eval_steps_per_second': 23.246, 'epoch': 3.74}
{'eval_loss': 0.48062431812286377, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9087543333230965, 'eval_runtime': 4.133, 'eval_samples_per_second': 183.884, 'eval_steps_per_second': 22.986, 'epoch': 3.98}
{'loss': 0.1055, 'grad_norm': 0.006627293769270182, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.5818989276885986, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9177548621461805, 'eval_runtime': 4.1816, 'eval_samples_per_second': 181.746, 'eval_steps_per_second': 22.718, 'epoch': 4.21}
{'eval_loss': 0.4931890666484833, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9217189406144702, 'eval_runtime': 4.0811, 'eval_samples_per_second': 186.222, 'eval_steps_per_second': 23.278, 'epoch': 4.44}
{'loss': 0.0443, 'grad_norm': 0.012709583155810833, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.5520634055137634, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9189489127968994, 'eval_runtime': 4.1056, 'eval_samples_per_second': 185.113, 'eval_steps_per_second': 23.139, 'epoch': 4.68}
{'eval_loss': 0.5540701746940613, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9134696618048536, 'eval_runtime': 4.3041, 'eval_samples_per_second': 176.577, 'eval_steps_per_second': 22.072, 'epoch': 4.91}
{'eval_loss': 0.6153008341789246, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9120717563289398, 'eval_runtime': 4.1621, 'eval_samples_per_second': 182.599, 'eval_steps_per_second': 22.825, 'epoch': 5.15}
{'loss': 0.0369, 'grad_norm': 0.002656202297657728, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.5463511347770691, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.915241021707531, 'eval_runtime': 4.1128, 'eval_samples_per_second': 184.789, 'eval_steps_per_second': 23.099, 'epoch': 5.38}
{'eval_loss': 0.6664623618125916, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9097579375926373, 'eval_runtime': 4.1562, 'eval_samples_per_second': 182.859, 'eval_steps_per_second': 22.857, 'epoch': 5.61}
{'loss': 0.0368, 'grad_norm': 0.004605263937264681, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.6141119003295898, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9133962262689008, 'eval_runtime': 4.0522, 'eval_samples_per_second': 187.551, 'eval_steps_per_second': 23.444, 'epoch': 5.85}
{'eval_loss': 0.6441017389297485, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9123478656828541, 'eval_runtime': 4.0388, 'eval_samples_per_second': 188.177, 'eval_steps_per_second': 23.522, 'epoch': 6.08}
{'eval_loss': 0.7164459228515625, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9051535218325611, 'eval_runtime': 4.3347, 'eval_samples_per_second': 175.33, 'eval_steps_per_second': 21.916, 'epoch': 6.32}
{'loss': 0.0216, 'grad_norm': 0.0015863834414631128, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.6905443072319031, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.912969068906293, 'eval_runtime': 4.1536, 'eval_samples_per_second': 182.975, 'eval_steps_per_second': 22.872, 'epoch': 6.55}
{'eval_loss': 0.7247317433357239, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9138832854085664, 'eval_runtime': 4.3374, 'eval_samples_per_second': 175.219, 'eval_steps_per_second': 21.902, 'epoch': 6.78}
{'loss': 0.0122, 'grad_norm': 0.00421356875449419, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.6575393080711365, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9168026147339621, 'eval_runtime': 4.3345, 'eval_samples_per_second': 175.339, 'eval_steps_per_second': 21.917, 'epoch': 7.02}
{'eval_loss': 0.707425594329834, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9151685656587911, 'eval_runtime': 4.2602, 'eval_samples_per_second': 178.394, 'eval_steps_per_second': 22.299, 'epoch': 7.25}
{'eval_loss': 0.6644665002822876, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9136194195533593, 'eval_runtime': 4.1012, 'eval_samples_per_second': 185.313, 'eval_steps_per_second': 23.164, 'epoch': 7.49}
{'loss': 0.0106, 'grad_norm': 0.0009173675789497793, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.7049897313117981, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9128308592827441, 'eval_runtime': 4.3014, 'eval_samples_per_second': 176.688, 'eval_steps_per_second': 22.086, 'epoch': 7.72}
{'eval_loss': 0.691259503364563, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9154637518616319, 'eval_runtime': 4.3183, 'eval_samples_per_second': 175.994, 'eval_steps_per_second': 21.999, 'epoch': 7.95}
{'loss': 0.0017, 'grad_norm': 0.0007136503118090332, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.70445716381073, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9136091595804515, 'eval_runtime': 4.1029, 'eval_samples_per_second': 185.233, 'eval_steps_per_second': 23.154, 'epoch': 8.19}
{'eval_loss': 0.7113755345344543, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9136091595804515, 'eval_runtime': 4.1575, 'eval_samples_per_second': 182.803, 'eval_steps_per_second': 22.85, 'epoch': 8.42}
{'eval_loss': 0.7403046488761902, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9108716236674536, 'eval_runtime': 4.0932, 'eval_samples_per_second': 185.675, 'eval_steps_per_second': 23.209, 'epoch': 8.65}
{'loss': 0.0001, 'grad_norm': 0.0006783074350096285, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.70760178565979, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9149253316728694, 'eval_runtime': 3.9734, 'eval_samples_per_second': 191.271, 'eval_steps_per_second': 23.909, 'epoch': 8.89}
{'eval_loss': 0.7147877216339111, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9149253316728694, 'eval_runtime': 3.9717, 'eval_samples_per_second': 191.354, 'eval_steps_per_second': 23.919, 'epoch': 9.12}
{'loss': 0.0005, 'grad_norm': 0.0011869549052789807, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.7181888222694397, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.916337598646889, 'eval_runtime': 4.0154, 'eval_samples_per_second': 189.272, 'eval_steps_per_second': 23.659, 'epoch': 9.36}
{'eval_loss': 0.7161893248558044, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9150329064694596, 'eval_runtime': 3.9953, 'eval_samples_per_second': 190.223, 'eval_steps_per_second': 23.778, 'epoch': 9.59}
{'eval_loss': 0.718500554561615, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9135592724458877, 'eval_runtime': 4.0095, 'eval_samples_per_second': 189.552, 'eval_steps_per_second': 23.694, 'epoch': 9.82}
{'loss': 0.0025, 'grad_norm': 0.0006968906382098794, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1636.3526, 'train_samples_per_second': 41.8, 'train_steps_per_second': 5.225, 'train_loss': 0.11130820324824175, 'epoch': 10.0}
