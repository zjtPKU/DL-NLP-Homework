/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1545: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3452/3452 [00:00<00:00, 14223.94 examples/s]
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1120/1120 [00:00<00:00, 16301.16 examples/s]
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
 12%|██████████████▎                                                                                                             | 500/4320 [00:25<02:32, 25.03it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.8757238388061523, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3276, 'eval_samples_per_second': 481.175, 'eval_steps_per_second': 60.147, 'epoch': 0.46}
{'eval_loss': 0.7850354909896851, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3194, 'eval_samples_per_second': 482.892, 'eval_steps_per_second': 60.361, 'epoch': 0.93}
{'loss': 0.9293, 'grad_norm': 0.3739296495914459, 'learning_rate': 4.4212962962962966e-05, 'epoch': 1.16}
 23%|████████████████████████████▍                                                                                              | 1000/4320 [00:53<02:13, 24.89it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.6945887207984924, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3319, 'eval_samples_per_second': 480.297, 'eval_steps_per_second': 60.037, 'epoch': 1.39}
{'eval_loss': 0.6719083786010742, 'eval_accuracy': 0.6517857142857143, 'eval_micro_f1': 0.6517857142857143, 'eval_macro_f1': 0.2697534647038263, 'eval_runtime': 2.3215, 'eval_samples_per_second': 482.444, 'eval_steps_per_second': 60.306, 'epoch': 1.85}
{'loss': 0.7386, 'grad_norm': 0.33816108107566833, 'learning_rate': 3.8425925925925924e-05, 'epoch': 2.31}
{'eval_loss': 0.6354130506515503, 'eval_accuracy': 0.7321428571428571, 'eval_micro_f1': 0.7321428571428571, 'eval_macro_f1': 0.5295413928829398, 'eval_runtime': 2.3256, 'eval_samples_per_second': 481.593, 'eval_steps_per_second': 60.199, 'epoch': 2.31}
 35%|██████████████████████████████████████████▋                                                                                | 1500/4320 [01:18<01:53, 24.82it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.6419839859008789, 'eval_accuracy': 0.7758928571428572, 'eval_micro_f1': 0.7758928571428572, 'eval_macro_f1': 0.5345393119530252, 'eval_runtime': 2.3392, 'eval_samples_per_second': 478.802, 'eval_steps_per_second': 59.85, 'epoch': 2.78}
{'eval_loss': 0.5892186760902405, 'eval_accuracy': 0.7741071428571429, 'eval_micro_f1': 0.7741071428571429, 'eval_macro_f1': 0.5328282828282828, 'eval_runtime': 2.3256, 'eval_samples_per_second': 481.601, 'eval_steps_per_second': 60.2, 'epoch': 3.24}
{'loss': 0.6611, 'grad_norm': 0.42013633251190186, 'learning_rate': 3.263888888888889e-05, 'epoch': 3.47}
 46%|████████████████████████████████████████████████████████▉                                                                  | 2000/4320 [01:46<01:34, 24.64it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5784972310066223, 'eval_accuracy': 0.7794642857142857, 'eval_micro_f1': 0.7794642857142857, 'eval_macro_f1': 0.5361909233383811, 'eval_runtime': 2.3306, 'eval_samples_per_second': 480.568, 'eval_steps_per_second': 60.071, 'epoch': 3.7}
{'eval_loss': 0.595158576965332, 'eval_accuracy': 0.7803571428571429, 'eval_micro_f1': 0.7803571428571429, 'eval_macro_f1': 0.538390356142457, 'eval_runtime': 2.3297, 'eval_samples_per_second': 480.743, 'eval_steps_per_second': 60.093, 'epoch': 4.17}
{'loss': 0.6146, 'grad_norm': 4.369786262512207, 'learning_rate': 2.6851851851851855e-05, 'epoch': 4.63}
{'eval_loss': 0.5826900005340576, 'eval_accuracy': 0.7785714285714286, 'eval_micro_f1': 0.7785714285714286, 'eval_macro_f1': 0.54026647163703, 'eval_runtime': 2.3341, 'eval_samples_per_second': 479.845, 'eval_steps_per_second': 59.981, 'epoch': 4.63}
 58%|███████████████████████████████████████████████████████████████████████▏                                                   | 2500/4320 [02:12<01:14, 24.55it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5677692294120789, 'eval_accuracy': 0.7839285714285714, 'eval_micro_f1': 0.7839285714285714, 'eval_macro_f1': 0.544623357756118, 'eval_runtime': 2.3301, 'eval_samples_per_second': 480.673, 'eval_steps_per_second': 60.084, 'epoch': 5.09}
{'eval_loss': 0.5739229321479797, 'eval_accuracy': 0.78125, 'eval_micro_f1': 0.78125, 'eval_macro_f1': 0.5435563231896327, 'eval_runtime': 2.3345, 'eval_samples_per_second': 479.758, 'eval_steps_per_second': 59.97, 'epoch': 5.56}
{'loss': 0.5995, 'grad_norm': 0.9059279561042786, 'learning_rate': 2.1064814814814816e-05, 'epoch': 5.79}
 69%|█████████████████████████████████████████████████████████████████████████████████████▍                                     | 3000/4320 [02:40<00:53, 24.52it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5632327795028687, 'eval_accuracy': 0.7883928571428571, 'eval_micro_f1': 0.7883928571428571, 'eval_macro_f1': 0.5609213065001937, 'eval_runtime': 2.3344, 'eval_samples_per_second': 479.787, 'eval_steps_per_second': 59.973, 'epoch': 6.02}
{'eval_loss': 0.5751937031745911, 'eval_accuracy': 0.7883928571428571, 'eval_micro_f1': 0.7883928571428571, 'eval_macro_f1': 0.5638880849777662, 'eval_runtime': 2.3354, 'eval_samples_per_second': 479.568, 'eval_steps_per_second': 59.946, 'epoch': 6.48}
{'loss': 0.5834, 'grad_norm': 0.8992111086845398, 'learning_rate': 1.527777777777778e-05, 'epoch': 6.94}
{'eval_loss': 0.5541888475418091, 'eval_accuracy': 0.7901785714285714, 'eval_micro_f1': 0.7901785714285714, 'eval_macro_f1': 0.5712484185686105, 'eval_runtime': 2.3603, 'eval_samples_per_second': 474.506, 'eval_steps_per_second': 59.313, 'epoch': 6.94}
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                       | 3500/4320 [03:06<00:33, 24.52it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5680598616600037, 'eval_accuracy': 0.7875, 'eval_micro_f1': 0.7875, 'eval_macro_f1': 0.5614317113163763, 'eval_runtime': 2.3466, 'eval_samples_per_second': 477.285, 'eval_steps_per_second': 59.661, 'epoch': 7.41}
{'eval_loss': 0.5569913983345032, 'eval_accuracy': 0.7910714285714285, 'eval_micro_f1': 0.7910714285714285, 'eval_macro_f1': 0.5723198833946603, 'eval_runtime': 2.3464, 'eval_samples_per_second': 477.336, 'eval_steps_per_second': 59.667, 'epoch': 7.87}
{'loss': 0.5655, 'grad_norm': 0.4800126552581787, 'learning_rate': 9.490740740740741e-06, 'epoch': 8.1}
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 4000/4320 [03:34<00:12, 24.63it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5514115691184998, 'eval_accuracy': 0.7955357142857142, 'eval_micro_f1': 0.7955357142857142, 'eval_macro_f1': 0.5886085509472606, 'eval_runtime': 2.3443, 'eval_samples_per_second': 477.75, 'eval_steps_per_second': 59.719, 'epoch': 8.33}
{'eval_loss': 0.5612922310829163, 'eval_accuracy': 0.7901785714285714, 'eval_micro_f1': 0.7901785714285714, 'eval_macro_f1': 0.5713731159674758, 'eval_runtime': 2.3418, 'eval_samples_per_second': 478.259, 'eval_steps_per_second': 59.782, 'epoch': 8.8}
{'loss': 0.5605, 'grad_norm': 1.96799635887146, 'learning_rate': 3.7037037037037037e-06, 'epoch': 9.26}
{'eval_loss': 0.5584012269973755, 'eval_accuracy': 0.7892857142857143, 'eval_micro_f1': 0.7892857142857143, 'eval_macro_f1': 0.5760874032006522, 'eval_runtime': 2.3445, 'eval_samples_per_second': 477.705, 'eval_steps_per_second': 59.713, 'epoch': 9.26}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 4318/4320 [03:50<00:00, 24.80it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.551066517829895, 'eval_accuracy': 0.7910714285714285, 'eval_micro_f1': 0.7910714285714285, 'eval_macro_f1': 0.5749361973506093, 'eval_runtime': 2.3446, 'eval_samples_per_second': 477.694, 'eval_steps_per_second': 59.712, 'epoch': 9.72}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4320/4320 [03:50<00:00, 18.71it/s]
{'train_runtime': 230.8876, 'train_samples_per_second': 149.51, 'train_steps_per_second': 18.71, 'train_loss': 0.6490826995284469, 'epoch': 10.0}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [00:02<00:00, 60.39it/s]
