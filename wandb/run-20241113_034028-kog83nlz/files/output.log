/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 7584.98 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 7056.32 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.3769665062427521, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9069680080112801, 'eval_runtime': 4.252, 'eval_samples_per_second': 178.738, 'eval_steps_per_second': 22.342, 'epoch': 0.23}
{'eval_loss': 0.30432870984077454, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114287740138466, 'eval_runtime': 4.2378, 'eval_samples_per_second': 179.337, 'eval_steps_per_second': 22.417, 'epoch': 0.47}
{'loss': 0.4706, 'grad_norm': 0.3781434893608093, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.28983360528945923, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9246317458099629, 'eval_runtime': 4.2455, 'eval_samples_per_second': 179.012, 'eval_steps_per_second': 22.376, 'epoch': 0.7}
{'eval_loss': 0.31339913606643677, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9155226123227622, 'eval_runtime': 4.1779, 'eval_samples_per_second': 181.91, 'eval_steps_per_second': 22.739, 'epoch': 0.94}
{'loss': 0.3589, 'grad_norm': 0.2281433343887329, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.4202900230884552, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9088978067837581, 'eval_runtime': 4.1711, 'eval_samples_per_second': 182.205, 'eval_steps_per_second': 22.776, 'epoch': 1.17}
{'eval_loss': 0.42071548104286194, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9137459228599503, 'eval_runtime': 4.1825, 'eval_samples_per_second': 181.708, 'eval_steps_per_second': 22.713, 'epoch': 1.4}
{'eval_loss': 0.31823980808258057, 'eval_accuracy': 0.9210526315789473, 'eval_micro_f1': 0.9210526315789473, 'eval_macro_f1': 0.9197656670596769, 'eval_runtime': 4.1971, 'eval_samples_per_second': 181.078, 'eval_steps_per_second': 22.635, 'epoch': 1.64}
{'loss': 0.2904, 'grad_norm': 5.328208923339844, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.31191080808639526, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9116724454103625, 'eval_runtime': 4.1796, 'eval_samples_per_second': 181.837, 'eval_steps_per_second': 22.73, 'epoch': 1.87}
{'eval_loss': 0.3964275121688843, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.91443434916798, 'eval_runtime': 4.2637, 'eval_samples_per_second': 178.249, 'eval_steps_per_second': 22.281, 'epoch': 2.11}
{'loss': 0.2183, 'grad_norm': 19.70903968811035, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.43661925196647644, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9112612549099885, 'eval_runtime': 4.1877, 'eval_samples_per_second': 181.484, 'eval_steps_per_second': 22.686, 'epoch': 2.34}
{'eval_loss': 0.3878495395183563, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9234007469451511, 'eval_runtime': 4.1811, 'eval_samples_per_second': 181.771, 'eval_steps_per_second': 22.721, 'epoch': 2.57}
{'eval_loss': 0.44372138381004333, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9206004716152317, 'eval_runtime': 4.1943, 'eval_samples_per_second': 181.199, 'eval_steps_per_second': 22.65, 'epoch': 2.81}
{'loss': 0.1778, 'grad_norm': 37.14847183227539, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.36294257640838623, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9207987716065206, 'eval_runtime': 4.18, 'eval_samples_per_second': 181.819, 'eval_steps_per_second': 22.727, 'epoch': 3.04}
{'eval_loss': 0.4571821391582489, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9151310943422705, 'eval_runtime': 4.2127, 'eval_samples_per_second': 180.408, 'eval_steps_per_second': 22.551, 'epoch': 3.27}
{'loss': 0.1125, 'grad_norm': 0.13151931762695312, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.487283319234848, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9204151429938295, 'eval_runtime': 4.184, 'eval_samples_per_second': 181.645, 'eval_steps_per_second': 22.706, 'epoch': 3.51}
{'eval_loss': 0.416216641664505, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9202254698673977, 'eval_runtime': 4.1992, 'eval_samples_per_second': 180.986, 'eval_steps_per_second': 22.623, 'epoch': 3.74}
{'eval_loss': 0.42115357518196106, 'eval_accuracy': 0.9171052631578948, 'eval_micro_f1': 0.9171052631578948, 'eval_macro_f1': 0.9152006619111882, 'eval_runtime': 4.199, 'eval_samples_per_second': 180.994, 'eval_steps_per_second': 22.624, 'epoch': 3.98}
{'loss': 0.1078, 'grad_norm': 0.005475066136568785, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.554470956325531, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9161787542924208, 'eval_runtime': 4.1644, 'eval_samples_per_second': 182.5, 'eval_steps_per_second': 22.813, 'epoch': 4.21}
{'eval_loss': 0.5530614852905273, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9107966918414641, 'eval_runtime': 4.2026, 'eval_samples_per_second': 180.84, 'eval_steps_per_second': 22.605, 'epoch': 4.44}
{'loss': 0.0486, 'grad_norm': 0.01585172675549984, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.5345169305801392, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.913609984515833, 'eval_runtime': 4.1239, 'eval_samples_per_second': 184.293, 'eval_steps_per_second': 23.037, 'epoch': 4.68}
{'eval_loss': 0.5189602375030518, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9141295005360169, 'eval_runtime': 4.1634, 'eval_samples_per_second': 182.543, 'eval_steps_per_second': 22.818, 'epoch': 4.91}
{'eval_loss': 0.5125551819801331, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9247029353377877, 'eval_runtime': 4.1587, 'eval_samples_per_second': 182.751, 'eval_steps_per_second': 22.844, 'epoch': 5.15}
{'loss': 0.0361, 'grad_norm': 0.00392478983849287, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.5477572083473206, 'eval_accuracy': 0.9223684210526316, 'eval_micro_f1': 0.9223684210526316, 'eval_macro_f1': 0.9207101464718238, 'eval_runtime': 4.1984, 'eval_samples_per_second': 181.022, 'eval_steps_per_second': 22.628, 'epoch': 5.38}
{'eval_loss': 0.5997464656829834, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9178739271462537, 'eval_runtime': 4.1523, 'eval_samples_per_second': 183.031, 'eval_steps_per_second': 22.879, 'epoch': 5.61}
{'loss': 0.0236, 'grad_norm': 0.01686115376651287, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.5908006429672241, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9253865411399658, 'eval_runtime': 4.1351, 'eval_samples_per_second': 183.793, 'eval_steps_per_second': 22.974, 'epoch': 5.85}
{'eval_loss': 0.5884960889816284, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9233348380481241, 'eval_runtime': 4.1968, 'eval_samples_per_second': 181.09, 'eval_steps_per_second': 22.636, 'epoch': 6.08}
{'eval_loss': 0.5949824452400208, 'eval_accuracy': 0.925, 'eval_micro_f1': 0.925, 'eval_macro_f1': 0.9232382712354499, 'eval_runtime': 4.1739, 'eval_samples_per_second': 182.083, 'eval_steps_per_second': 22.76, 'epoch': 6.32}
{'loss': 0.0203, 'grad_norm': 0.0017634861869737506, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.6053158640861511, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9242606260022553, 'eval_runtime': 4.1331, 'eval_samples_per_second': 183.882, 'eval_steps_per_second': 22.985, 'epoch': 6.55}
{'eval_loss': 0.5850554704666138, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259759695647264, 'eval_runtime': 4.1837, 'eval_samples_per_second': 181.659, 'eval_steps_per_second': 22.707, 'epoch': 6.78}
{'loss': 0.0167, 'grad_norm': 0.010705738328397274, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.5746397376060486, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9256501666713458, 'eval_runtime': 4.1287, 'eval_samples_per_second': 184.077, 'eval_steps_per_second': 23.01, 'epoch': 7.02}
{'eval_loss': 0.6120091676712036, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9258318916517015, 'eval_runtime': 4.175, 'eval_samples_per_second': 182.037, 'eval_steps_per_second': 22.755, 'epoch': 7.25}
{'eval_loss': 0.6305036544799805, 'eval_accuracy': 0.9289473684210526, 'eval_micro_f1': 0.9289473684210526, 'eval_macro_f1': 0.9270802268376233, 'eval_runtime': 4.1002, 'eval_samples_per_second': 185.355, 'eval_steps_per_second': 23.169, 'epoch': 7.49}
{'loss': 0.0142, 'grad_norm': 0.0025391802191734314, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.6206346154212952, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9218315872284095, 'eval_runtime': 4.1572, 'eval_samples_per_second': 182.815, 'eval_steps_per_second': 22.852, 'epoch': 7.72}
{'eval_loss': 0.6556127071380615, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243665778305581, 'eval_runtime': 4.14, 'eval_samples_per_second': 183.573, 'eval_steps_per_second': 22.947, 'epoch': 7.95}
{'loss': 0.0034, 'grad_norm': 0.0014765015803277493, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.6841904520988464, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9242751080508284, 'eval_runtime': 4.1557, 'eval_samples_per_second': 182.881, 'eval_steps_per_second': 22.86, 'epoch': 8.19}
{'eval_loss': 0.6882081627845764, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243673453335822, 'eval_runtime': 4.2128, 'eval_samples_per_second': 180.403, 'eval_steps_per_second': 22.55, 'epoch': 8.42}
{'eval_loss': 0.6954668760299683, 'eval_accuracy': 0.9263157894736842, 'eval_micro_f1': 0.9263157894736842, 'eval_macro_f1': 0.9243673453335822, 'eval_runtime': 4.1916, 'eval_samples_per_second': 181.314, 'eval_steps_per_second': 22.664, 'epoch': 8.65}
{'loss': 0.0001, 'grad_norm': 0.0007142971153371036, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.664441704750061, 'eval_accuracy': 0.9315789473684211, 'eval_micro_f1': 0.9315789473684211, 'eval_macro_f1': 0.929920898324435, 'eval_runtime': 4.1795, 'eval_samples_per_second': 181.838, 'eval_steps_per_second': 22.73, 'epoch': 8.89}
{'eval_loss': 0.6748983263969421, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259374152851632, 'eval_runtime': 4.2006, 'eval_samples_per_second': 180.928, 'eval_steps_per_second': 22.616, 'epoch': 9.12}
{'loss': 0.0024, 'grad_norm': 0.0020659316796809435, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.6877641081809998, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.1568, 'eval_samples_per_second': 182.834, 'eval_steps_per_second': 22.854, 'epoch': 9.36}
{'eval_loss': 0.6870204210281372, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.2141, 'eval_samples_per_second': 180.349, 'eval_steps_per_second': 22.544, 'epoch': 9.59}
{'eval_loss': 0.6852336525917053, 'eval_accuracy': 0.9276315789473685, 'eval_micro_f1': 0.9276315789473685, 'eval_macro_f1': 0.9259123570387504, 'eval_runtime': 4.2051, 'eval_samples_per_second': 180.735, 'eval_steps_per_second': 22.592, 'epoch': 9.82}
{'loss': 0.001, 'grad_norm': 0.003695489140227437, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1636.3395, 'train_samples_per_second': 41.801, 'train_steps_per_second': 5.225, 'train_loss': 0.11126542986109199, 'epoch': 10.0}
