/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 7519.75 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 8004.96 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                                                      
                                                                                                                                                                                                      
{'eval_loss': 0.4942646920681, 'eval_accuracy': 0.875, 'eval_micro_f1': 0.875, 'eval_macro_f1': 0.8729553866592696, 'eval_runtime': 4.153, 'eval_samples_per_second': 182.998, 'eval_steps_per_second': 22.875, 'epoch': 0.23}
{'eval_loss': 0.43214118480682373, 'eval_accuracy': 0.8736842105263158, 'eval_micro_f1': 0.8736842105263158, 'eval_macro_f1': 0.8726628369074108, 'eval_runtime': 4.1185, 'eval_samples_per_second': 184.532, 'eval_steps_per_second': 23.067, 'epoch': 0.47}
{'loss': 0.6029, 'grad_norm': 1.202524185180664, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.38355037569999695, 'eval_accuracy': 0.8789473684210526, 'eval_micro_f1': 0.8789473684210526, 'eval_macro_f1': 0.8765486428901278, 'eval_runtime': 4.1537, 'eval_samples_per_second': 182.971, 'eval_steps_per_second': 22.871, 'epoch': 0.7}
{'eval_loss': 0.36523622274398804, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.895046979036458, 'eval_runtime': 4.204, 'eval_samples_per_second': 180.781, 'eval_steps_per_second': 22.598, 'epoch': 0.94}
{'loss': 0.4737, 'grad_norm': 5.592627048492432, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.5243293642997742, 'eval_accuracy': 0.8894736842105263, 'eval_micro_f1': 0.8894736842105263, 'eval_macro_f1': 0.8871759670573767, 'eval_runtime': 4.1193, 'eval_samples_per_second': 184.499, 'eval_steps_per_second': 23.062, 'epoch': 1.17}
{'eval_loss': 0.41674771904945374, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.901162383235566, 'eval_runtime': 4.168, 'eval_samples_per_second': 182.34, 'eval_steps_per_second': 22.792, 'epoch': 1.4}
{'eval_loss': 0.4576190412044525, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.8956841238589592, 'eval_runtime': 4.1266, 'eval_samples_per_second': 184.169, 'eval_steps_per_second': 23.021, 'epoch': 1.64}
{'loss': 0.396, 'grad_norm': 22.183704376220703, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3590734302997589, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089866015522654, 'eval_runtime': 4.1675, 'eval_samples_per_second': 182.366, 'eval_steps_per_second': 22.796, 'epoch': 1.87}
{'eval_loss': 0.4226562976837158, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9065038632233025, 'eval_runtime': 4.1889, 'eval_samples_per_second': 181.433, 'eval_steps_per_second': 22.679, 'epoch': 2.11}
{'loss': 0.2962, 'grad_norm': 4.242546558380127, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.5018460154533386, 'eval_accuracy': 0.8960526315789473, 'eval_micro_f1': 0.8960526315789473, 'eval_macro_f1': 0.8945341660894879, 'eval_runtime': 4.1413, 'eval_samples_per_second': 183.516, 'eval_steps_per_second': 22.94, 'epoch': 2.34}
{'eval_loss': 0.47794297337532043, 'eval_accuracy': 0.9, 'eval_micro_f1': 0.9, 'eval_macro_f1': 0.8978676831557365, 'eval_runtime': 4.1427, 'eval_samples_per_second': 183.457, 'eval_steps_per_second': 22.932, 'epoch': 2.57}
{'eval_loss': 0.44557222723960876, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9074226988660251, 'eval_runtime': 4.2647, 'eval_samples_per_second': 178.205, 'eval_steps_per_second': 22.276, 'epoch': 2.81}
{'loss': 0.2825, 'grad_norm': 4.705611705780029, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.44803500175476074, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9085271066542933, 'eval_runtime': 4.2301, 'eval_samples_per_second': 179.665, 'eval_steps_per_second': 22.458, 'epoch': 3.04}
{'eval_loss': 0.5402993559837341, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9043969243710427, 'eval_runtime': 4.2519, 'eval_samples_per_second': 178.742, 'eval_steps_per_second': 22.343, 'epoch': 3.27}
{'loss': 0.1916, 'grad_norm': 0.12186618894338608, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.5564286708831787, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9018478681430718, 'eval_runtime': 4.2953, 'eval_samples_per_second': 176.939, 'eval_steps_per_second': 22.117, 'epoch': 3.51}
{'eval_loss': 0.5251957178115845, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9020558142047285, 'eval_runtime': 4.2612, 'eval_samples_per_second': 178.352, 'eval_steps_per_second': 22.294, 'epoch': 3.74}
{'eval_loss': 0.420758455991745, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9114449118667993, 'eval_runtime': 4.2194, 'eval_samples_per_second': 180.12, 'eval_steps_per_second': 22.515, 'epoch': 3.98}
{'loss': 0.1527, 'grad_norm': 0.025987721979618073, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.5562556385993958, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9090201189693898, 'eval_runtime': 4.3298, 'eval_samples_per_second': 175.526, 'eval_steps_per_second': 21.941, 'epoch': 4.21}
{'eval_loss': 0.48447442054748535, 'eval_accuracy': 0.9013157894736842, 'eval_micro_f1': 0.9013157894736842, 'eval_macro_f1': 0.8999899955605952, 'eval_runtime': 4.4038, 'eval_samples_per_second': 172.579, 'eval_steps_per_second': 21.572, 'epoch': 4.44}
{'loss': 0.1165, 'grad_norm': 0.06041907146573067, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.4884072542190552, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9056533245312938, 'eval_runtime': 4.261, 'eval_samples_per_second': 178.361, 'eval_steps_per_second': 22.295, 'epoch': 4.68}
{'eval_loss': 0.5518621206283569, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.9033143490252284, 'eval_runtime': 4.3011, 'eval_samples_per_second': 176.699, 'eval_steps_per_second': 22.087, 'epoch': 4.91}
{'eval_loss': 0.5942729711532593, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9098525818362672, 'eval_runtime': 4.3852, 'eval_samples_per_second': 173.311, 'eval_steps_per_second': 21.664, 'epoch': 5.15}
{'loss': 0.1125, 'grad_norm': 0.025464391335844994, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.6257044672966003, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.9023962372341734, 'eval_runtime': 4.2669, 'eval_samples_per_second': 178.117, 'eval_steps_per_second': 22.265, 'epoch': 5.38}
{'eval_loss': 0.6236940026283264, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9061077613079628, 'eval_runtime': 4.4242, 'eval_samples_per_second': 171.784, 'eval_steps_per_second': 21.473, 'epoch': 5.61}
{'loss': 0.0699, 'grad_norm': 0.4322117865085602, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.6030922532081604, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.9034946445869058, 'eval_runtime': 4.1963, 'eval_samples_per_second': 181.113, 'eval_steps_per_second': 22.639, 'epoch': 5.85}
{'eval_loss': 0.5918014645576477, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9112755602970811, 'eval_runtime': 4.3276, 'eval_samples_per_second': 175.617, 'eval_steps_per_second': 21.952, 'epoch': 6.08}
{'eval_loss': 0.7009384036064148, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.9005307137438535, 'eval_runtime': 4.287, 'eval_samples_per_second': 177.28, 'eval_steps_per_second': 22.16, 'epoch': 6.32}
{'loss': 0.0341, 'grad_norm': 0.007231921888887882, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.7234513163566589, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9070786162864639, 'eval_runtime': 4.3071, 'eval_samples_per_second': 176.452, 'eval_steps_per_second': 22.057, 'epoch': 6.55}
{'eval_loss': 0.6523517966270447, 'eval_accuracy': 0.9157894736842105, 'eval_micro_f1': 0.9157894736842105, 'eval_macro_f1': 0.9142906618412391, 'eval_runtime': 4.2558, 'eval_samples_per_second': 178.578, 'eval_steps_per_second': 22.322, 'epoch': 6.78}
{'loss': 0.033, 'grad_norm': 0.007217213977128267, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.7015069127082825, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9076090836945446, 'eval_runtime': 4.181, 'eval_samples_per_second': 181.773, 'eval_steps_per_second': 22.722, 'epoch': 7.02}
{'eval_loss': 0.6840078234672546, 'eval_accuracy': 0.9184210526315789, 'eval_micro_f1': 0.9184210526315789, 'eval_macro_f1': 0.9169554199750882, 'eval_runtime': 4.3335, 'eval_samples_per_second': 175.377, 'eval_steps_per_second': 21.922, 'epoch': 7.25}
{'eval_loss': 0.725619375705719, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9046091904955947, 'eval_runtime': 4.1529, 'eval_samples_per_second': 183.005, 'eval_steps_per_second': 22.876, 'epoch': 7.49}
{'loss': 0.0212, 'grad_norm': 0.8161358833312988, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.752044677734375, 'eval_accuracy': 0.9039473684210526, 'eval_micro_f1': 0.9039473684210526, 'eval_macro_f1': 0.90213947893889, 'eval_runtime': 4.376, 'eval_samples_per_second': 173.675, 'eval_steps_per_second': 21.709, 'epoch': 7.72}
{'eval_loss': 0.6939637064933777, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9102940184082321, 'eval_runtime': 4.3362, 'eval_samples_per_second': 175.27, 'eval_steps_per_second': 21.909, 'epoch': 7.95}
{'loss': 0.0138, 'grad_norm': 0.004061795771121979, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.7593196034431458, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.9034285254546562, 'eval_runtime': 4.3109, 'eval_samples_per_second': 176.296, 'eval_steps_per_second': 22.037, 'epoch': 8.19}
{'eval_loss': 0.7530771493911743, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.908870549540406, 'eval_runtime': 4.35, 'eval_samples_per_second': 174.714, 'eval_steps_per_second': 21.839, 'epoch': 8.42}
{'eval_loss': 0.7493464350700378, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9102803038347251, 'eval_runtime': 4.2991, 'eval_samples_per_second': 176.781, 'eval_steps_per_second': 22.098, 'epoch': 8.65}
{'loss': 0.0023, 'grad_norm': 0.002706590574234724, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.7177851796150208, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.912851193350875, 'eval_runtime': 4.3121, 'eval_samples_per_second': 176.247, 'eval_steps_per_second': 22.031, 'epoch': 8.89}
{'eval_loss': 0.7325295805931091, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9115397324066055, 'eval_runtime': 4.1997, 'eval_samples_per_second': 180.966, 'eval_steps_per_second': 22.621, 'epoch': 9.12}
{'loss': 0.0065, 'grad_norm': 0.0019719384144991636, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.7438288927078247, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9075313818348807, 'eval_runtime': 4.1584, 'eval_samples_per_second': 182.761, 'eval_steps_per_second': 22.845, 'epoch': 9.36}
{'eval_loss': 0.7331035137176514, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9102555566672186, 'eval_runtime': 4.2703, 'eval_samples_per_second': 177.973, 'eval_steps_per_second': 22.247, 'epoch': 9.59}
{'eval_loss': 0.743790328502655, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9128992958102043, 'eval_runtime': 4.2309, 'eval_samples_per_second': 179.633, 'eval_steps_per_second': 22.454, 'epoch': 9.82}
{'loss': 0.0066, 'grad_norm': 0.003522956743836403, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1750.7959, 'train_samples_per_second': 39.068, 'train_steps_per_second': 4.883, 'train_loss': 0.16444254860951843, 'epoch': 10.0}
