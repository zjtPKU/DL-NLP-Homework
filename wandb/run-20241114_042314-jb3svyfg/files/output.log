/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1545: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3452/3452 [00:00<00:00, 15192.43 examples/s]
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1120/1120 [00:00<00:00, 11022.98 examples/s]
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
 12%|██████████████▎                                                                                                             | 500/4320 [00:25<02:33, 24.91it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.8757238388061523, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3231, 'eval_samples_per_second': 482.118, 'eval_steps_per_second': 60.265, 'epoch': 0.46}
{'eval_loss': 0.7850354909896851, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3189, 'eval_samples_per_second': 482.991, 'eval_steps_per_second': 60.374, 'epoch': 0.93}
{'loss': 0.9293, 'grad_norm': 0.3739296495914459, 'learning_rate': 4.4212962962962966e-05, 'epoch': 1.16}
 23%|████████████████████████████▍                                                                                              | 1000/4320 [00:53<02:13, 24.95it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.6945887207984924, 'eval_accuracy': 0.65, 'eval_micro_f1': 0.65, 'eval_macro_f1': 0.2626262626262626, 'eval_runtime': 2.3283, 'eval_samples_per_second': 481.032, 'eval_steps_per_second': 60.129, 'epoch': 1.39}
{'eval_loss': 0.6719083786010742, 'eval_accuracy': 0.6517857142857143, 'eval_micro_f1': 0.6517857142857143, 'eval_macro_f1': 0.2697534647038263, 'eval_runtime': 2.3257, 'eval_samples_per_second': 481.567, 'eval_steps_per_second': 60.196, 'epoch': 1.85}
{'loss': 0.7386, 'grad_norm': 0.33816108107566833, 'learning_rate': 3.8425925925925924e-05, 'epoch': 2.31}
{'eval_loss': 0.6354130506515503, 'eval_accuracy': 0.7321428571428571, 'eval_micro_f1': 0.7321428571428571, 'eval_macro_f1': 0.5295413928829398, 'eval_runtime': 2.3301, 'eval_samples_per_second': 480.659, 'eval_steps_per_second': 60.082, 'epoch': 2.31}
 35%|██████████████████████████████████████████▋                                                                                | 1500/4320 [01:19<01:52, 25.07it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.6419839859008789, 'eval_accuracy': 0.7758928571428572, 'eval_micro_f1': 0.7758928571428572, 'eval_macro_f1': 0.5345393119530252, 'eval_runtime': 2.3517, 'eval_samples_per_second': 476.248, 'eval_steps_per_second': 59.531, 'epoch': 2.78}
{'eval_loss': 0.5892186760902405, 'eval_accuracy': 0.7741071428571429, 'eval_micro_f1': 0.7741071428571429, 'eval_macro_f1': 0.5328282828282828, 'eval_runtime': 2.3475, 'eval_samples_per_second': 477.101, 'eval_steps_per_second': 59.638, 'epoch': 3.24}
{'loss': 0.6611, 'grad_norm': 0.42013633251190186, 'learning_rate': 3.263888888888889e-05, 'epoch': 3.47}
 46%|████████████████████████████████████████████████████████▉                                                                  | 2000/4320 [01:47<01:34, 24.61it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5784972310066223, 'eval_accuracy': 0.7794642857142857, 'eval_micro_f1': 0.7794642857142857, 'eval_macro_f1': 0.5361909233383811, 'eval_runtime': 2.3386, 'eval_samples_per_second': 478.914, 'eval_steps_per_second': 59.864, 'epoch': 3.7}
{'eval_loss': 0.595158576965332, 'eval_accuracy': 0.7803571428571429, 'eval_micro_f1': 0.7803571428571429, 'eval_macro_f1': 0.538390356142457, 'eval_runtime': 2.3412, 'eval_samples_per_second': 478.378, 'eval_steps_per_second': 59.797, 'epoch': 4.17}
{'loss': 0.6146, 'grad_norm': 4.369786262512207, 'learning_rate': 2.6851851851851855e-05, 'epoch': 4.63}
{'eval_loss': 0.5826900005340576, 'eval_accuracy': 0.7785714285714286, 'eval_micro_f1': 0.7785714285714286, 'eval_macro_f1': 0.54026647163703, 'eval_runtime': 2.3419, 'eval_samples_per_second': 478.242, 'eval_steps_per_second': 59.78, 'epoch': 4.63}
 58%|███████████████████████████████████████████████████████████████████████▏                                                   | 2500/4320 [02:13<01:13, 24.73it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5677692294120789, 'eval_accuracy': 0.7839285714285714, 'eval_micro_f1': 0.7839285714285714, 'eval_macro_f1': 0.544623357756118, 'eval_runtime': 2.3384, 'eval_samples_per_second': 478.963, 'eval_steps_per_second': 59.87, 'epoch': 5.09}
{'eval_loss': 0.5739229321479797, 'eval_accuracy': 0.78125, 'eval_micro_f1': 0.78125, 'eval_macro_f1': 0.5435563231896327, 'eval_runtime': 2.341, 'eval_samples_per_second': 478.421, 'eval_steps_per_second': 59.803, 'epoch': 5.56}
{'loss': 0.5995, 'grad_norm': 0.9059279561042786, 'learning_rate': 2.1064814814814816e-05, 'epoch': 5.79}
 69%|█████████████████████████████████████████████████████████████████████████████████████▍                                     | 3000/4320 [02:42<00:53, 24.61it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5632327795028687, 'eval_accuracy': 0.7883928571428571, 'eval_micro_f1': 0.7883928571428571, 'eval_macro_f1': 0.5609213065001937, 'eval_runtime': 2.3395, 'eval_samples_per_second': 478.739, 'eval_steps_per_second': 59.842, 'epoch': 6.02}
{'eval_loss': 0.5751937031745911, 'eval_accuracy': 0.7883928571428571, 'eval_micro_f1': 0.7883928571428571, 'eval_macro_f1': 0.5638880849777662, 'eval_runtime': 2.3459, 'eval_samples_per_second': 477.422, 'eval_steps_per_second': 59.678, 'epoch': 6.48}
{'loss': 0.5834, 'grad_norm': 0.8992111086845398, 'learning_rate': 1.527777777777778e-05, 'epoch': 6.94}
{'eval_loss': 0.5541888475418091, 'eval_accuracy': 0.7901785714285714, 'eval_micro_f1': 0.7901785714285714, 'eval_macro_f1': 0.5712484185686105, 'eval_runtime': 2.3361, 'eval_samples_per_second': 479.439, 'eval_steps_per_second': 59.93, 'epoch': 6.94}
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                       | 3500/4320 [03:08<00:33, 24.55it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5680598616600037, 'eval_accuracy': 0.7875, 'eval_micro_f1': 0.7875, 'eval_macro_f1': 0.5614317113163763, 'eval_runtime': 2.3568, 'eval_samples_per_second': 475.227, 'eval_steps_per_second': 59.403, 'epoch': 7.41}
{'eval_loss': 0.5569913983345032, 'eval_accuracy': 0.7910714285714285, 'eval_micro_f1': 0.7910714285714285, 'eval_macro_f1': 0.5723198833946603, 'eval_runtime': 2.3515, 'eval_samples_per_second': 476.287, 'eval_steps_per_second': 59.536, 'epoch': 7.87}
{'loss': 0.5655, 'grad_norm': 0.4800126552581787, 'learning_rate': 9.490740740740741e-06, 'epoch': 8.1}
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 4000/4320 [03:36<00:12, 24.65it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.5514115691184998, 'eval_accuracy': 0.7955357142857142, 'eval_micro_f1': 0.7955357142857142, 'eval_macro_f1': 0.5886085509472606, 'eval_runtime': 2.3472, 'eval_samples_per_second': 477.161, 'eval_steps_per_second': 59.645, 'epoch': 8.33}
{'eval_loss': 0.5612922310829163, 'eval_accuracy': 0.7901785714285714, 'eval_micro_f1': 0.7901785714285714, 'eval_macro_f1': 0.5713731159674758, 'eval_runtime': 2.3428, 'eval_samples_per_second': 478.056, 'eval_steps_per_second': 59.757, 'epoch': 8.8}
{'loss': 0.5605, 'grad_norm': 1.96799635887146, 'learning_rate': 3.7037037037037037e-06, 'epoch': 9.26}
{'eval_loss': 0.5584012269973755, 'eval_accuracy': 0.7892857142857143, 'eval_micro_f1': 0.7892857142857143, 'eval_macro_f1': 0.5760874032006522, 'eval_runtime': 2.3411, 'eval_samples_per_second': 478.417, 'eval_steps_per_second': 59.802, 'epoch': 9.26}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 4319/4320 [03:53<00:00, 24.55it/s]/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/integrations/peft.py:397: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(                                                                                                                                                    
{'eval_loss': 0.551066517829895, 'eval_accuracy': 0.7910714285714285, 'eval_micro_f1': 0.7910714285714285, 'eval_macro_f1': 0.5749361973506093, 'eval_runtime': 2.3451, 'eval_samples_per_second': 477.595, 'eval_steps_per_second': 59.699, 'epoch': 9.72}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4320/4320 [03:54<00:00, 18.46it/s]
{'train_runtime': 234.0753, 'train_samples_per_second': 147.474, 'train_steps_per_second': 18.456, 'train_loss': 0.6490826995284469, 'epoch': 10.0}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [00:02<00:00, 60.36it/s]
