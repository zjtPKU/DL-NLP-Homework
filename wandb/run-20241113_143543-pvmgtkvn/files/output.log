/scratch/zhoujunting/anaconda3/envs/MAGA/lib/python3.10/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6840/6840 [00:00<00:00, 13283.95 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 760/760 [00:00<00:00, 12279.78 examples/s]
/scratch/zhoujunting/zjt/task2.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                                    
                                                                                                                                                                    
{'eval_loss': 0.4942646920681, 'eval_accuracy': 0.875, 'eval_micro_f1': 0.875, 'eval_macro_f1': 0.8729553866592696, 'eval_runtime': 3.9295, 'eval_samples_per_second': 193.406, 'eval_steps_per_second': 24.176, 'epoch': 0.23}
{'eval_loss': 0.43214118480682373, 'eval_accuracy': 0.8736842105263158, 'eval_micro_f1': 0.8736842105263158, 'eval_macro_f1': 0.8726628369074108, 'eval_runtime': 3.9058, 'eval_samples_per_second': 194.58, 'eval_steps_per_second': 24.323, 'epoch': 0.47}
{'loss': 0.6029, 'grad_norm': 1.202524185180664, 'learning_rate': 4.707602339181287e-05, 'epoch': 0.58}
{'eval_loss': 0.38355037569999695, 'eval_accuracy': 0.8789473684210526, 'eval_micro_f1': 0.8789473684210526, 'eval_macro_f1': 0.8765486428901278, 'eval_runtime': 3.9348, 'eval_samples_per_second': 193.15, 'eval_steps_per_second': 24.144, 'epoch': 0.7}
{'eval_loss': 0.36523622274398804, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.895046979036458, 'eval_runtime': 3.9028, 'eval_samples_per_second': 194.731, 'eval_steps_per_second': 24.341, 'epoch': 0.94}
{'loss': 0.4737, 'grad_norm': 5.592627048492432, 'learning_rate': 4.4152046783625734e-05, 'epoch': 1.17}
{'eval_loss': 0.5243293642997742, 'eval_accuracy': 0.8894736842105263, 'eval_micro_f1': 0.8894736842105263, 'eval_macro_f1': 0.8871759670573767, 'eval_runtime': 3.9055, 'eval_samples_per_second': 194.6, 'eval_steps_per_second': 24.325, 'epoch': 1.17}
{'eval_loss': 0.41674771904945374, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.901162383235566, 'eval_runtime': 3.9922, 'eval_samples_per_second': 190.373, 'eval_steps_per_second': 23.797, 'epoch': 1.4}
{'eval_loss': 0.4576190412044525, 'eval_accuracy': 0.8973684210526316, 'eval_micro_f1': 0.8973684210526316, 'eval_macro_f1': 0.8956841238589592, 'eval_runtime': 3.9186, 'eval_samples_per_second': 193.946, 'eval_steps_per_second': 24.243, 'epoch': 1.64}
{'loss': 0.396, 'grad_norm': 22.183704376220703, 'learning_rate': 4.12280701754386e-05, 'epoch': 1.75}
{'eval_loss': 0.3590734302997589, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089866015522654, 'eval_runtime': 3.9133, 'eval_samples_per_second': 194.212, 'eval_steps_per_second': 24.276, 'epoch': 1.87}
{'eval_loss': 0.4239235818386078, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9103886883936007, 'eval_runtime': 3.913, 'eval_samples_per_second': 194.223, 'eval_steps_per_second': 24.278, 'epoch': 2.11}
{'loss': 0.2946, 'grad_norm': 5.829248428344727, 'learning_rate': 3.8304093567251465e-05, 'epoch': 2.34}
{'eval_loss': 0.4757457971572876, 'eval_accuracy': 0.9026315789473685, 'eval_micro_f1': 0.9026315789473685, 'eval_macro_f1': 0.9010971102838844, 'eval_runtime': 3.8677, 'eval_samples_per_second': 196.498, 'eval_steps_per_second': 24.562, 'epoch': 2.34}
{'eval_loss': 0.443818598985672, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.905865062748331, 'eval_runtime': 3.9181, 'eval_samples_per_second': 193.973, 'eval_steps_per_second': 24.247, 'epoch': 2.57}
{'eval_loss': 0.4175073802471161, 'eval_accuracy': 0.9197368421052632, 'eval_micro_f1': 0.9197368421052632, 'eval_macro_f1': 0.9181548118494647, 'eval_runtime': 3.9416, 'eval_samples_per_second': 192.814, 'eval_steps_per_second': 24.102, 'epoch': 2.81}
{'loss': 0.2856, 'grad_norm': 5.171096324920654, 'learning_rate': 3.538011695906433e-05, 'epoch': 2.92}
{'eval_loss': 0.43462419509887695, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9044444282899957, 'eval_runtime': 3.8958, 'eval_samples_per_second': 195.083, 'eval_steps_per_second': 24.385, 'epoch': 3.04}
{'eval_loss': 0.4953891932964325, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9223467215010251, 'eval_runtime': 3.8834, 'eval_samples_per_second': 195.707, 'eval_steps_per_second': 24.463, 'epoch': 3.27}
{'loss': 0.1825, 'grad_norm': 0.41820257902145386, 'learning_rate': 3.24561403508772e-05, 'epoch': 3.51}
{'eval_loss': 0.5639689564704895, 'eval_accuracy': 0.9052631578947369, 'eval_micro_f1': 0.9052631578947369, 'eval_macro_f1': 0.9034241327864798, 'eval_runtime': 3.8966, 'eval_samples_per_second': 195.042, 'eval_steps_per_second': 24.38, 'epoch': 3.51}
{'eval_loss': 0.5380851030349731, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089606651118144, 'eval_runtime': 3.9294, 'eval_samples_per_second': 193.413, 'eval_steps_per_second': 24.177, 'epoch': 3.74}
{'eval_loss': 0.4359726011753082, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9090372778670744, 'eval_runtime': 3.9356, 'eval_samples_per_second': 193.11, 'eval_steps_per_second': 24.139, 'epoch': 3.98}
{'loss': 0.1619, 'grad_norm': 0.015128525905311108, 'learning_rate': 2.9532163742690062e-05, 'epoch': 4.09}
{'eval_loss': 0.44554081559181213, 'eval_accuracy': 0.9236842105263158, 'eval_micro_f1': 0.9236842105263158, 'eval_macro_f1': 0.9221610795602737, 'eval_runtime': 3.8995, 'eval_samples_per_second': 194.898, 'eval_steps_per_second': 24.362, 'epoch': 4.21}
{'eval_loss': 0.5052478909492493, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9056829006906406, 'eval_runtime': 3.923, 'eval_samples_per_second': 193.73, 'eval_steps_per_second': 24.216, 'epoch': 4.44}
{'loss': 0.1065, 'grad_norm': 0.053458865731954575, 'learning_rate': 2.6608187134502928e-05, 'epoch': 4.68}
{'eval_loss': 0.5448353886604309, 'eval_accuracy': 0.9118421052631579, 'eval_micro_f1': 0.9118421052631579, 'eval_macro_f1': 0.9101561569722626, 'eval_runtime': 3.8958, 'eval_samples_per_second': 195.084, 'eval_steps_per_second': 24.386, 'epoch': 4.68}
{'eval_loss': 0.5320771932601929, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9090873900157711, 'eval_runtime': 3.9159, 'eval_samples_per_second': 194.082, 'eval_steps_per_second': 24.26, 'epoch': 4.91}
{'eval_loss': 0.6247122287750244, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9047864688633944, 'eval_runtime': 3.9396, 'eval_samples_per_second': 192.914, 'eval_steps_per_second': 24.114, 'epoch': 5.15}
{'loss': 0.1051, 'grad_norm': 0.019366636872291565, 'learning_rate': 2.368421052631579e-05, 'epoch': 5.26}
{'eval_loss': 0.6131150126457214, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9117087898237003, 'eval_runtime': 3.9496, 'eval_samples_per_second': 192.424, 'eval_steps_per_second': 24.053, 'epoch': 5.38}
{'eval_loss': 0.6604526042938232, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9067919385164582, 'eval_runtime': 3.8977, 'eval_samples_per_second': 194.988, 'eval_steps_per_second': 24.373, 'epoch': 5.61}
{'loss': 0.0787, 'grad_norm': 1.0005452632904053, 'learning_rate': 2.0760233918128656e-05, 'epoch': 5.85}
{'eval_loss': 0.5721262693405151, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.90751642973708, 'eval_runtime': 3.9071, 'eval_samples_per_second': 194.516, 'eval_steps_per_second': 24.315, 'epoch': 5.85}
{'eval_loss': 0.5761553049087524, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9073693235708672, 'eval_runtime': 3.9173, 'eval_samples_per_second': 194.01, 'eval_steps_per_second': 24.251, 'epoch': 6.08}
{'eval_loss': 0.6481543183326721, 'eval_accuracy': 0.9131578947368421, 'eval_micro_f1': 0.9131578947368421, 'eval_macro_f1': 0.9115338552012983, 'eval_runtime': 3.8897, 'eval_samples_per_second': 195.387, 'eval_steps_per_second': 24.423, 'epoch': 6.32}
{'loss': 0.0461, 'grad_norm': 0.007073090877383947, 'learning_rate': 1.7836257309941522e-05, 'epoch': 6.43}
{'eval_loss': 0.6717299818992615, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9129817402965946, 'eval_runtime': 3.8665, 'eval_samples_per_second': 196.56, 'eval_steps_per_second': 24.57, 'epoch': 6.55}
{'eval_loss': 0.6948290467262268, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9077391683035954, 'eval_runtime': 3.906, 'eval_samples_per_second': 194.573, 'eval_steps_per_second': 24.322, 'epoch': 6.78}
{'loss': 0.0333, 'grad_norm': 0.013701132498681545, 'learning_rate': 1.4912280701754386e-05, 'epoch': 7.02}
{'eval_loss': 0.697459876537323, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9053210136571349, 'eval_runtime': 3.9083, 'eval_samples_per_second': 194.456, 'eval_steps_per_second': 24.307, 'epoch': 7.02}
{'eval_loss': 0.7057106494903564, 'eval_accuracy': 0.9144736842105263, 'eval_micro_f1': 0.9144736842105263, 'eval_macro_f1': 0.9128486980605087, 'eval_runtime': 3.8993, 'eval_samples_per_second': 194.909, 'eval_steps_per_second': 24.364, 'epoch': 7.25}
{'eval_loss': 0.6816324591636658, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9091327894636718, 'eval_runtime': 3.9201, 'eval_samples_per_second': 193.873, 'eval_steps_per_second': 24.234, 'epoch': 7.49}
{'loss': 0.022, 'grad_norm': 0.006855531129986048, 'learning_rate': 1.1988304093567252e-05, 'epoch': 7.6}
{'eval_loss': 0.6978484988212585, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9087201969045766, 'eval_runtime': 3.9339, 'eval_samples_per_second': 193.192, 'eval_steps_per_second': 24.149, 'epoch': 7.72}
{'eval_loss': 0.7377017140388489, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9049828583049297, 'eval_runtime': 3.9139, 'eval_samples_per_second': 194.177, 'eval_steps_per_second': 24.272, 'epoch': 7.95}
{'loss': 0.0128, 'grad_norm': 0.001547307358123362, 'learning_rate': 9.064327485380117e-06, 'epoch': 8.19}
{'eval_loss': 0.7722211480140686, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9048694251208227, 'eval_runtime': 3.8784, 'eval_samples_per_second': 195.959, 'eval_steps_per_second': 24.495, 'epoch': 8.19}
{'eval_loss': 0.7860285639762878, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.906026138455101, 'eval_runtime': 3.9313, 'eval_samples_per_second': 193.323, 'eval_steps_per_second': 24.165, 'epoch': 8.42}
{'eval_loss': 0.7740087509155273, 'eval_accuracy': 0.9105263157894737, 'eval_micro_f1': 0.9105263157894737, 'eval_macro_f1': 0.9089386991261129, 'eval_runtime': 3.9238, 'eval_samples_per_second': 193.69, 'eval_steps_per_second': 24.211, 'epoch': 8.65}
{'loss': 0.0025, 'grad_norm': 0.0032429462298750877, 'learning_rate': 6.140350877192982e-06, 'epoch': 8.77}
{'eval_loss': 0.8114262819290161, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9050065024468941, 'eval_runtime': 3.9211, 'eval_samples_per_second': 193.821, 'eval_steps_per_second': 24.228, 'epoch': 8.89}
{'eval_loss': 0.7968701124191284, 'eval_accuracy': 0.9078947368421053, 'eval_micro_f1': 0.9078947368421053, 'eval_macro_f1': 0.9060234542960792, 'eval_runtime': 3.9062, 'eval_samples_per_second': 194.563, 'eval_steps_per_second': 24.32, 'epoch': 9.12}
{'loss': 0.0044, 'grad_norm': 0.001872047781944275, 'learning_rate': 3.216374269005848e-06, 'epoch': 9.36}
{'eval_loss': 0.799990713596344, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9047028558785342, 'eval_runtime': 3.8786, 'eval_samples_per_second': 195.945, 'eval_steps_per_second': 24.493, 'epoch': 9.36}
{'eval_loss': 0.8007941246032715, 'eval_accuracy': 0.9092105263157895, 'eval_micro_f1': 0.9092105263157895, 'eval_macro_f1': 0.9073737700539979, 'eval_runtime': 3.896, 'eval_samples_per_second': 195.072, 'eval_steps_per_second': 24.384, 'epoch': 9.59}
{'eval_loss': 0.798729419708252, 'eval_accuracy': 0.906578947368421, 'eval_micro_f1': 0.906578947368421, 'eval_macro_f1': 0.9048555883112961, 'eval_runtime': 3.9164, 'eval_samples_per_second': 194.054, 'eval_steps_per_second': 24.257, 'epoch': 9.82}
{'loss': 0.0025, 'grad_norm': 0.0019424412166699767, 'learning_rate': 2.9239766081871344e-07, 'epoch': 9.94}
{'train_runtime': 1478.5888, 'train_samples_per_second': 46.26, 'train_steps_per_second': 5.783, 'train_loss': 0.16440130363174915, 'epoch': 10.0}
